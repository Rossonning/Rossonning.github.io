---
title: Unity Handbook - Creative Core
categories: GameDev
tags:
- GameDev
---

- [Mission 1 - Intro](#mission-1---intro)
  - [开始您的指导项目](#开始您的指导项目)
    - [4.什么是渲染？](#4什么是渲染)
    - [5.什么是渲染管线？](#5什么是渲染管线)
    - [6.选择渲染管线](#6选择渲染管线)
    - [7.创建一个新的URP项目](#7创建一个新的urp项目)
    - [8.新建场景并导入资源](#8新建场景并导入资源)
  - [Unity 文档入门](#unity-文档入门)
- [Mission 2 着色器和材质](#mission-2-着色器和材质)
  - [开始使用着色器和材质](#开始使用着色器和材质)
  - [探索网格(Meshes)和渲染(rendering)](#探索网格meshes和渲染rendering)
      - [网格是如何制作的？](#网格是如何制作的)
    - [4.网格过滤器(Mesh filter) 和渲染器组件(Renderer Component)](#4网格过滤器mesh-filter-和渲染器组件renderer-component)
    - [5.在网格渲染器中应用材质](#5在网格渲染器中应用材质)
  - [探索着色器(Shader)](#探索着色器shader)
    - [2.着色器的类型](#2着色器的类型)
    - [3.基于物理的着色器和渲染](#3基于物理的着色器和渲染)
    - [4.通用渲染管线中的着色器](#4通用渲染管线中的着色器)
  - [管理项目中的材料(Materials)](#管理项目中的材料materials)
    - [2.着色器和材质之间有什么关系？](#2着色器和材质之间有什么关系)
    - [3.修复洋红色材质](#3修复洋红色材质)
    - [4.观察默认材质](#4观察默认材质)
    - [5.在 Project 窗口中查找材料](#5在-project-窗口中查找材料)
    - [6.将材质应用到游戏对象](#6将材质应用到游戏对象)
    - [7.更换材质](#7更换材质)
    - [8.找到应用于游戏对象的材质](#8找到应用于游戏对象的材质)
    - [9.创建新材质](#9创建新材质)
    - [10.复制材质](#10复制材质)
  - [模拟固体表面](#模拟固体表面)
    - [4.漫反射率：底图(base map)](#4漫反射率底图base-map)
    - [5.高光工作流程中的金属](#5高光工作流程中的金属)
    - [6.金属工作流程中的金属](#6金属工作流程中的金属)
    - [7.平滑度](#7平滑度)
    - [8.探索：创建固体材料](#8探索创建固体材料)
  - [贴图(Map)材质与纹理](#贴图map材质与纹理)
    - [2.什么是纹理？](#2什么是纹理)
    - [3.检查纹理文件](#3检查纹理文件)
    - [4.使用底图纹理更改颜色](#4使用底图纹理更改颜色)
    - [5.平铺纹理(Tiled textures)](#5平铺纹理tiled-textures)
    - [6.UV贴图纹理](#6uv贴图纹理)
    - [8.将纹理与模型相匹配](#8将纹理与模型相匹配)
  - [创建半透明和透明效果](#创建半透明和透明效果)
    - [2. Alpha 通道的透明度](#2-alpha-通道的透明度)
    - [3.创建玻璃材质](#3创建玻璃材质)
    - [4.通过 Alpha 剪切添加细节](#4通过-alpha-剪切添加细节)
    - [5.探索透明效果](#5探索透明效果)
  - [使用凹凸贴图(bump mapping)添加物理纹理](#使用凹凸贴图bump-mapping添加物理纹理)
    - [2.什么是凹凸贴图？](#2什么是凹凸贴图)
    - [3.使用法线贴图添加表面细节](#3使用法线贴图添加表面细节)
    - [4.使用高度图添加浮雕](#4使用高度图添加浮雕)
  - [使用更多纹理贴图细化表面](#使用更多纹理贴图细化表面)
    - [2.使用遮挡贴图(occlusion maps)强化阴影](#2使用遮挡贴图occlusion-maps强化阴影)
    - [3.使用微表面贴图(microsurface maps)添加细节](#3使用微表面贴图microsurface-maps添加细节)
    - [4.使用发射贴图(emission maps)照亮表面](#4使用发射贴图emission-maps照亮表面)
  - [开始使用 Shader Graph](#开始使用-shader-graph)
    - [2.打开Shader Graph](#2打开shader-graph)
    - [3.添加程序图(procedural map)](#3添加程序图procedural-map)
    - [4.随着时间的推移创造运动(motion)](#4随着时间的推移创造运动motion)
    - [5.添加输入材质属性](#5添加输入材质属性)
    - [6.组合贴图(Combine maps)](#6组合贴图combine-maps)
    - [7.对节点进行分组以保持组织有序](#7对节点进行分组以保持组织有序)
    - [8.允许材质中的纹理缩放](#8允许材质中的纹理缩放)
    - [9.调整对比度](#9调整对比度)
    - [10.调整颜色和透明度](#10调整颜色和透明度)
    - [11.完成着色器](#11完成着色器)
    - [12.创建测试材料](#12创建测试材料)
    - [13.探索 Shader Graph](#13探索-shader-graph)
- [Mission 3 光照](#mission-3-光照)
  - [Unity 中的光照入门](#unity-中的光照入门)
    - [2.检查外部照明示例](#2检查外部照明示例)
    - [4.Unity的全局照明系统](#4unity的全局照明系统)
    - [5.Unity中的实时光照](#5unity中的实时光照)
    - [6.Unity中的烘焙光照](#6unity中的烘焙光照)
  - [配置定向光和天空盒](#配置定向光和天空盒)
    - [3. 识别光源类型](#3-识别光源类型)
    - [4.配置定向光](#4配置定向光)
    - [5.定向光的高级使用](#5定向光的高级使用)
    - [6.开始使用天空盒](#6开始使用天空盒)
    - [7.创建一个新的程序天空盒](#7创建一个新的程序天空盒)
    - [8.打造深夜妆容](#8打造深夜妆容)
    - [将光源添加到场景中](#将光源添加到场景中)
    - [光源类型](#光源类型)
    - [Light 组件配置](#light-组件配置)
    - [色彩空间](#色彩空间)
    - [7.配置环境灯光](#7配置环境灯光)
  - [配置场景中的阴影](#配置场景中的阴影)
    - [2.配置渲染管线资源](#2配置渲染管线资源)
    - [3.在定向光中启用软阴影](#3在定向光中启用软阴影)
    - [4.考虑post-processing对光照的影响](#4考虑post-processing对光照的影响)
  - [为您的场景烘焙光照贴图](#为您的场景烘焙光照贴图)
    - [2.什么是烘焙照明？](#2什么是烘焙照明)
    - [3.改变灯光模式](#3改变灯光模式)
    - [4.将光源设置为静态](#4将光源设置为静态)
    - [5.烘焙光照贴图](#5烘焙光照贴图)
    - [6.添加区域光(Area Light)](#6添加区域光area-light)
    - [7.将灯光模式设置为 Mixed](#7将灯光模式设置为-mixed)
  - [使用光探针改善您的照明](#使用光探针改善您的照明)
    - [2.动态对象](#2动态对象)
    - [4.我怎么知道把它们放在哪里？](#4我怎么知道把它们放在哪里)
    - [5.将光探针放置在场景中](#5将光探针放置在场景中)
    - [7.尝试使用一些工具来检查场景](#7尝试使用一些工具来检查场景)
    - [8.探索：自定义您的光照贴图](#8探索自定义您的光照贴图)
  - [检查并完成室内场景](#检查并完成室内场景)


# Mission 1 - Intro

## 开始您的指导项目

### 4.什么是渲染？
渲染是获取三维 (3D) 数据并使用它为屏幕生成二维 (2D) 图像的过程。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211125/learn/images/eef5c79e-b93b-4e62-9436-eb13bd2c237f_image22.png.2000x0x1.png)

让我们进一步细分：
在 Unity 中，您可以定位 3D 模型、将材质应用于这些模型，并将虚拟相机对准它们。渲染正在吸收所有数据（对象几何形状、位置、颜色、照明等）并从相机的角度生成图像。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211125/learn/images/31381681-ff92-4efb-97b4-78f0abf30d44_image12.png.2000x0x1.png)

现在您知道了什么是渲染，让我们继续讨论第二个词：管道。


### 5.什么是渲染管线？
如果渲染是从 A 点到 B 点（3D 数据到 2D 图像）的过程，那么您可以将渲染管道视为到达那里的不同方式。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211125/learn/images/c0124772-aba8-49de-abe0-e5b97ed2815e_image16.png.2000x0x1.png)

由于每个渲染管道使用不同的技术和计算来生成 2D 图像，因此结果可能会有所不同，具体取决于您选择的管道。

为您的项目选择渲染管道就像选择步行、骑自行车还是开车到达目的地一样；没有一种选择本质上比另一种更好或更差——这仅取决于您的目标！

正如步行、骑自行车和开车各有优缺点一样，不同的渲染管道也各有优缺点。一种是最快的，一种可能是最简单的，有时，一种根本不适合您想要去的地方！这就是为什么选择最适合您的项目目标的渲染管道很重要。


### 6.选择渲染管线

有什么选择？

让我们更详细地回顾一下您在 Hub 中查看的模板选项，包括它们的优点和缺点：

- Unity 的内置渲染管道适用于所有平台并且非常可靠。它很容易使用，但它内置于 Unity 中，因此不太可定制。它也不是最有效的。
- **通用渲染管道( URP )** 非常适合移动、Web 和 VR 项目，因为它针对性能进行了高度优化。它的配置有点复杂，但比内置渲染管道更可定制。它可以产生相当不错的图形。
- **高清渲染管道( HDRP )** 旨在为具有充足处理能力的高端平台（例如控制台或游戏计算机）生成高质量图形。它的配置非常复杂，因此只能由具有丰富图形经验的人使用。

URP 和 HDRP 都是 **可编写脚本的渲染管道( SRP )** 。 SRP 是高度可定制的，甚至可以从头开始编写。由于编写渲染管道是一项艰巨的任务，Unity 提供了这两个 SRP 作为模板，可以处理大多数项目。

做出决定

那么，您应该选择哪一个呢？

让我们立即排除 HDRP，因为我们的目标不是极高端机器，而且它需要大量的图形专业知识。

但是您应该如何在内置渲染管线和 URP 之间进行选择呢？这条途径的重点是让您学习和尝试 Unity 创意系统的核心功能，包括光照、材质、后处理和视觉效果。因此，选择 URP 而不是内置渲染管线的一些原因如下：

- **URP** 比内置渲染器管道更具可定制性，允许您进行更多实验。
- 一些非常强大的新编辑器功能（例如 Shader Graph 和 VFX Graph）仅与 URP 兼容，而不与内置渲染管道兼容。
- URP 项目针对您想要的目标平台（Web、桌面、移动或 VR）上的性能进行了优化。

总而言之：HDRP 太花哨了，而且内置渲染管道的可定制性不足以满足我们想要做的事情 - **因此我们将在整个路径中使用 URP。**


![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211125/learn/images/2e3f88de-9d7e-4700-a3ea-c15817eaf1ed_image18.png.2000x0x1.png)

选择渲染管道时可能涉及的决策：

![image](https://docs.unity3d.com/2019.3/Documentation/uploads/Main/BestPracticeLightingPipeline16.svg)

### 7.创建一个新的URP项目

渲染管道决策完成后，您就可以创建项目了。

1. 使用 **3D 示例场景 (URP)** (Universal 3D sample) 模板创建一个新的 Unity 项目。将其命名为 `GuidedProjectAlienVideoGameShop` （或您选择的任何设计文档）。
    Unity 将开放一个示例项目来展示 URP 的功能。花点时间欣赏一下 URP 模板附带的美丽示例场景。

    现在让我们看看是什么让这个项目成为 URP 项目。

2. 从主菜单中，选择 编辑>项目设置>质量 。在面板的中心，您将看到“低” 、“中”和“高质量”级别，以及一个绿色复选框，指示每个目标平台的默认质量级别。 
    ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20230804/learn/images/14370e7c-7ac9-4a5e-9be6-0a1c5e0405e3_image.png.2000x0x1.png)

3. 单击“低” 、“中”和“高”设置，并注意“场景”视图中的变化，重点关注半涂蓝色墙壁上的阴影、灯光和反射。
   当您循环浏览这些质量设置时，您实际上正在更改用于渲染场景的  URP 资源。

   ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20230804/learn/images/1699578a-39e7-4c69-a306-6fb164c8ef95_image.png.2000x0x1.png)

    `URP 资源` 控制项目中的许多质量设置（尤其是与光和阴影相关的设置），并且可以像任何其他资源一样在 Project 窗口中找到。

4. 在“质量设置”窗口中，双击名为 **UniversalRP - High/Medium/LowQuality** 的 URP 资产。

这将在 Project 窗口中找到该资源，并在“检查器”中显示其属性。浏览 URP 资源中可用的设置，特别是与光和阴影相关的设置。如果您不明白它们的含义，请不要担心 - 您将在整个路径中了解有关这些设置的更多信息。如果您想提前了解这些设置，请查看URP 资产文档。

对 URP 有了更清晰的了解后，您就可以为您的指导项目制作新场景了。

### 8.新建场景并导入资源

尽管这个示例场景很漂亮，但它肯定不符合您所选设计文档的要求。您需要一个新的空白场景来工作。

1. 在 Project 窗口的“场景”文件夹中，创建一个名为 `AlienVideoGameStore` 的新场景，然后打开新的空场景。如果需要，您现在还可以删除 `SampleScene` 和 `SampleSceneLightingSettings` 。
   
   ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211125/learn/images/a8a8f244-b9dd-42d4-b8e9-bdb244f0f8c8_image5.png.2000x0x1.png)

   望向默认场景中广阔空旷的天空，您会发现自己渴望有资产来填充它。  

2.  将 `GuidedProjectStarterFiles` 下载到您的计算机，导入项目。
3.  资源导入完成后，您可以随意浏览资源库的目录。在 GuidedProject 文件夹中，您将找到每个标志性设计的文件夹：外星人视频游戏商店、建筑渲染和海滨小镇。
   ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211206/learn/images/b5b41c17-c991-4a05-914a-fa1864788a03_image1.png.2000x0x1.png)

4. 从 `[YourProjectDirectory] ​​> Assets > GuidedProject > [YourChosenProject] > Prefabs` 中，将 `StarterEnvironment` 资源拖动到层次结构中以将其添加到场景中。如果某些物体缺少粉红色材料，那也没关系！您将在着色器和材质任务中修复该问题。

## Unity 文档入门

![Unity文档网站](https://docs.unity.com/) 是您有关 Unity 所有内容的参考库。

# Mission 2 着色器和材质

## 开始使用着色器和材质

在开始之前，如果您愿意，可以通过以下一些方法来设置项目：

1. 您将看到一些图标，指示您将在其他 Creative Core 学习体验中了解的照明功能。要隐藏它们，请打开 **Scene** 视图窗口右上角的 **Gizmos** 下拉菜单，然后将 `3D Icon` 一直调整到最低值。保持 `3D Icon` 启用。
   ![Gizmos](https://docs.unity3d.com/uploads/Main/gizmo-button-scene-view.png)

2. 如果您看到其他黄线，请禁用Gizmos菜单中的LightProbeGroup 。

3. 要隐藏或查看网格，请使用 Scene 视图控制栏左侧的 网格视图切换按钮。该图标有一个网格和表示 Y 平面的 Y

## 探索网格(Meshes)和渲染(rendering)

用技术术语来说，着色器和材质在网格上运行，网格是游戏对象的表面。它们指示 Unity 的渲染器如何渲染每个网格。在本教程中，您将了解网格和渲染。

学完本教程后，您将能够：
- 定义网格、其特征及其在渲染 3D 游戏对象中的用途
- 解释着色器在渲染过程中的作用
- 将材质分配给游戏对象

每个渲染的 3D 游戏对象都有一个称为网格的几何形状。让我们仔细看看 Unity 编辑器中的网格。

1. 在 Scene 视图中，找到窗口右上角的 `Draw mode` 下拉列表。默认情况下，它设置为 `Shaded` 。
   ![image](https://docs.unity3d.com/uploads/Main/SceneViewControlBar.png)
   第一个icon

2. 使用下拉菜单将绘制模式更改为 `Wireframe` 。
 
这就是 3D 场景本身的样子——没有着色器和材质：
![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/d0e7cc70-ed8e-44ae-92d8-6aa27dff2f5c_CC_Shad_Mesh_1.png.2000x0x1.png)

网格是游戏对象的 3D 骨架。 

Unity 中的每个游戏对象都有一个网格。它是物体的几何元素。

着色器和材质告诉 Unity 您希望如何将 3D 游戏对象的网格 从 3D 场景渲染到屏幕上的 2D 图像。 

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/6644a697-d323-4cd2-af32-38aadd2c4b42_CC_Shad_Mesh_2.png.2000x0x1.png)

> 网格是一系列由顶点（单数：vertex ）定义的平面 2D多边形，顶点是 3D 空间中存储为 XYZ 坐标的点。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/4018953b-4e44-43d4-a0de-a0b8f7eb30ab_CC_Shad_Mesh_3.png.2000x0x1.png)

如果 3D 物体仅由 2D 多边形制成，它就会像钻石或其他宝石一样具有刻面。 3D 网格需要额外的信息才能使其在某些地方显得平滑或弯曲。

网格数据还包括 **法线** ，它们是定义表面面向的方向的附加值。当所有法线都垂直于边缘时，形状就会显得平坦且多面，如下图所示。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/5bc76c0e-2b5d-433f-8b08-9832eee9044b_CC_Shad_Mesh_5.png.2000x0x1.png)

法线表示多边形的形状；例如，它是弯曲的而不是平坦的，以及它是如何弯曲的。着色器根据法线将网格渲染为弯曲的，而不实际更改网格。球体实际上是由许多平坦表面组成的网格，但其法线使表面显得光滑。

着色器的工作是考虑来自顶点和法线的所有数据以准确表示网格表面。

#### 网格是如何制作的？
您可以轻松地将简单的原始形状（例如立方体和球体）添加到 Unity 项目中。任何比这更复杂的东西都是在专门的应用程序中创建的，例如 
- Blender®
- Autodesk® 3ds Max®  
- Maya®
- Adobe® Substance 3D Collection® 
- Pixologic® ZBrush®

### 4.网格过滤器(Mesh filter) 和渲染器组件(Renderer Component)
当您选择苹果或任何非空游戏对象，并在检查器中查看其组件时，网格由网格过滤器组件和网格渲染器组件表示。

1. 在工作台上，选择任意苹果。
2. 在层次结构中，您将看到苹果是一个带有两个子游戏对象的空游戏对象。从层次结构中，选择子 `AppleBody` 。
3. 在检查器中，查看 `Apple Body (Mesh Filter)` 和 `Mesh Renderer ` 。

**Mesh Filter component**
网格过滤器组件指向项目中的网格坐标数据。

如果您愿意，您甚至可以在此处替换网格，方法是选择对象选择器（圆形图标）并从项目中的任何其他对象（例如苹果）中选取网格。

有时，如果您在 Unity 中的游戏对象上做了很多工作（例如，使用着色器和材质或动画），然后想要更改网格，则这会很有用 - 您可以重新导入新网格并替换它。

**Mesh Renderer component**
网格渲染器组件是您指定网格渲染方式的位置。

这里有几个属性，但最重要的一个是 `materials` 。在这些教程中，您将经常返回网格渲染器组件以将材质应用到游戏对象。

### 5.在网格渲染器中应用材质

`material` 是一种与着色器一起定义网格渲染方式的资源。一种材质可以应用于多种网格。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/53faa02d-8b96-4928-aef5-469f89fa568b_CC_Shad_Mesh_6.png.2000x0x1.png)


让我们使用网格渲染器组件将材质应用到工作台上的白苹果：

1. 如果尚未返回到 `Shaded view` ，请返回。
2. 在层次结构中，选择名为 `Apple` 的游戏对象，或者在场景视图中，选择白苹果。
    1. 如有必要，将其移至您可以看到的地方。 （此游戏对象有子游戏对象；移动时请务必选择父对象。）
3. 在层次结构中，选择 `AppleBody` 子对象。
4. 在检查器中，找到 `Mesh Renderer`。
   1. 在这里，您将看到标题为 `Materials` 的部分，其中包含一个标记为 `Element 0` 的项目。 （如果 `Element 0` 不可见，您可能需要选择左侧的折叠页（三角形图标）来展开此部分。）
   2. 您将在此处 Apply material 。
   3. 
   ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/ec7ecc93-30a3-4d29-8040-e4986642d975_CC_Shad_Mesh_7.png.2000x0x1.png)
   
   4. （加号 ( + ) 和减号 ( - ) 按钮允许您从应用于对象的材料列表中添加和删除材质。虽然可以将多种材质应用于一个游戏对象，但这超出了本项目的范围。） 

5. 让我们通过更换材质来使这个苹果看起来更像一个苹果。在网格渲染器组件中，选择材质名称右侧的对象选择器（圆形图标）。将出现 `Select Material` 对话框窗口。搜索 AppleRed 并选择它。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/83710269-750e-437b-8eaf-d5b94bb8e442_CC_Shad_Mesh_8.png.2000x0x1.png)
   2. 在检查器中，请注意窗口底部或附近的部分（材质检查器），其中列出了材质的属性。此部分的标题将为您刚刚应用的材料的名称。 （您可能需要选择左侧的折页（三角形图标）来展开此部分。）您将在此处创建和配置材质。
   3. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/0eb593a8-4712-4993-8bef-c401aa468194_CC_Shad_Mesh_9.png.2000x0x1.png)

## 探索着色器(Shader)

着色器是一个脚本，它应用材质中包含的属性 将 3D 对象 的 meshes 渲染到屏幕上的 2D 图像。

每个着色器都是为特定 [render pipeline](https://learn.unity.com/tutorial/get-started-on-your-guided-project#619fbf21edbc2a39aabd80eb) 编写的。 

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/f9a7bbfa-9e76-42f3-bf2c-7ef4bdd896a9_CC_Shad_Shdrs_1.png.2000x0x1.png)

您使用的着色器取决于您的渲染管道。

在 Unity 中，每个模板都附带专门为模板中使用的渲染管道设计的着色器。

着色器可以有很大的不同，提供多种可以应用于您的项目的视觉样式。在稍后的学习体验中，您甚至将学习如何创建自己的着色器！

### 2.着色器的类型

总的来说，着色器中发生两种类型的操作：**片段着色(Fragment shading)** 和 **顶点着色(Vertex shading)** 。

片段着色，也称为像素着色，是表示网格表面以产生 2D 图像中每个像素的颜色的着色。在此项目中，我们将使用片段着色器并详细讨论它们如何使用场景中的光线进行渲染。

顶点着色作用于网格的顶点，通常会更改其位置以使表面移动或变换。我们不会在本次学习体验中介绍顶点着色，但我们将在未来的教程中提供更多资源。

您经常会看到着色器被称为片段着色器或顶点着色器，具体取决于它们的主要用途，但所有着色器都可以执行这两种操作。

### 3.基于物理的着色器和渲染

随着计算机变得越来越强大并且渲染技术不断发展，**基于物理的渲染 (PBR)** 已经变得更加广泛。 

PBR 模拟现实世界的物理和光原理，以在 3D 表面上生成逼真的阴影、反射、环境光和其他光效果。[您可以在 Unity 手册中了解有关这些原则的更多信息](https://docs.unity3d.com/Manual/shader-StandardShader.html)。

使用 PBR ，灯光和表面的属性保持分离。

灯光是根据亮度、颜色和范围来定义的。

表面是使用材料根据颜色、反射率和其他影响光在表面上的行为的现实世界属性来定义的。 （您将在本次学习体验中了解这些现实世界的属性。）然后，着色器根据场景的灯光、表面和 3D 几何体以及其他因素来计算从表面反射的光的质量。

在下图中，每个表面的外观随着场景中光线的变化而变化。每个图像中的表面属性都是相同的——只是光线的颜色和方向发生了变化。

![video](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/77875b15-bebe-427b-a7d9-5c436beff2c3_PBRExample.gif._gif_.mp4)


另一方面，对于 **非基于物理的渲染** ，渲染的颜色、阴影和反射要么在没有 PBR 科学的情况下进行近似，要么根本不渲染。

使用非 PBR 着色器，红色材质可能会渲染为纯红色或具有简单的反射和阴影。

非 PBR 通常看起来不像 PBR 那样真实，但对于风格化效果来说它可能更理想。

**卡通着色器是一种非 PBR 着色器，它使 3D 场景中的表面看起来像 2D 卡通。**

### 4.通用渲染管线中的着色器

着色器必须与项目的 `渲染管道` 兼容。

在本次学习体验中，我们将在通用 `渲染管道 (URP)` 项目中工作，因此我们将仅使用 URP 着色器。让我们快速浏览一下一些 URP 着色器。

您会看到许多着色器的名称中都包含 **Lit** 或 **Unlit** 。

**Lit** 着色器会对场景中的光线做出响应，而 **Unlit** 的着色器则不会。

**Unlit** 着色器对于某些艺术效果 或 通过不使用光照来更有效地运行的优化项目很有用。

> 注意：更改已创建材质的着色器（正如您将在本演示中所做的那样）并不常见，因为材质基于特定着色器的属性。通常，您将首先选择一个着色器，然后为该着色器配置材质。

浏览着色器：

1. 在工作台上选择一个黄色柠檬（不是白色柠檬）。
2. 在检查器中，找到位于检查器窗口底部的 material 检查器，并根据需要展开该部分。
3. 在 material 检查器 顶部的材质缩略图附近，找到 `Shader` 属性。
4. 使用下拉列表查看着色器类别列表。选择 `Universal Render Pipeline` 以查看 URP 着色器。
5. 选择黄色柠檬游戏对象后，选择每个 URP 着色器并注意结果。请务必从 `Universal Render Pipeline` 子菜单中选择着色器。
   1. **2D > Sprite-Lit-Default:** 专为 2D 项目设计，此着色器仅适用于平面对象，并将任何 3D 对象渲染为 2D。作为光照着色器，它将根据场景中到达对象的光线进行渲染。
   2. **Particles > Lit, Simple Lit, and Unlit:** 这些着色器用于视觉效果 (VFX)。在创意核心途径中，您将在 VFX 任务中使用这些着色器。
   3. **Terrain > Lit:** 此着色器针对与 Unity 中的 Terrain 工具一起使用进行了优化。在创意核心途径中，您将在原型制作任务中使用此着色器。
   4. **Baked Lit:** 此着色器会自动应用于 `Lightmapping` ，您将在创意核心途径的光照任务中遇到它。
   5. **Complex Lit, Lit, and Simple Lit:** 这些都是通用的、基于物理的光照着色器的变体。
   6. **Unlit** 如上所述，不使用光的着色器。

在本次学习体验中，我们将使用 **Universal Render Pipeline/Lit Shader,** ，这是一种基于物理的着色器。因为它是基于物理的，所以我们定义的材质将基于现实世界表面的属性，例如反照率颜色、镜面反射值和反射率 - 您将在以后的教程中学习这些概念。 

## 管理项目中的材料(Materials)
您将使用 Material 为 3D 对象着色、纹理和风格化来完成许多更具艺术性的工作。在本教程中，您将了解 Material 的工作原理，以及如何在项目中使用它们、排除故障和组织它们。

学完本教程后，您将能够：

- 定义 Material 
- 创建新 Material 
- 将 Material 分配给游戏对象
- 将 Material 作为项目资产进行管理
- 修复损坏的（洋红色） Material 

### 2.着色器和材质之间有什么关系？

着色器可以非常具体，也可以非常通用。

着色器可以设置游戏对象的颜色，也可以允许颜色通过材质进行配置。事实上，**一个着色器可以使许多对象看起来像完全不同的物质，同时仍然赋予场景统一的外观**。

在我们的画廊中，您看到的所有内容都使用 URP/Lit 着色器！这些游戏对象看起来不同的原因是材质为着色器提供的属性，包括颜色和平滑度。

着色器和材质作为一个团队一起工作 - the shader defines what a surface can look like, while the material defines what it does look like.

### 3.修复洋红色材质

您的工作台上有一个问题需要注意：明亮的洋红色柠檬。这个柠檬并不是设计成这种颜色的——洋红色（粉红色）表示存在需要修复的错误。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/243cda32-2d06-47af-ad20-35e3a3af752a_CC_Shad_Mats_A.png.2000x0x1.png)

每种材质都是专门为特定着色器编写的。

将资源从一个项目导入另一个项目是一种常见的做法，但有时这些项目的渲染管道不匹配，因此着色器也不匹配。

**当材质的着色器与当前渲染管道不匹配时**，它会以 **明亮的洋红色（粉色）** 来提醒您。

修复这个柠檬：

1. 在场景视图中，选择明亮的洋红色柠檬。
   
2. 在检查器中，检查其材料。其着色器设置为 `Standard` 。当您在Unity中看到 `Standard` 作为着色器的名称时，它很可能是内置渲染管道的标准着色器，它在通用渲染管道中不起作用。我们需要将其更改为 `URP` 着色器。

3. 从 `Shader dropdown` 中，选择 ` Universal Render Pipeline > Lit` 。柠檬看起来不错！

损坏的材料现在已修复 - 但并非所有损坏的材料都这么容易修复。

在这种情况下，材质很容易转换，因为两个着色器的材质属性相似。在其他情况下，您可能会遇到名称截然不同或完全不同的材质属性，并且您必须手动重置它们。

**URP自动材料升级**

该项目中的其他一些材料也已损坏，以便我们可以演示 URP 的内置工具来转换损坏的材料。您可以在 Project 窗口的 `Assets > CreativeCore_Shaders > Materials > Standard` 文件夹中查看这些材质。

请按照以下说明升级项目中的所有材料：

1. 从主菜单中，导航至 `Window > Rendering > Render Pipeline Converter` 以打开 ` Render Pipeline Converter` 窗口。此窗口允许您将多种类型的资产更新为最新的 URP 标准。
2. 窗口顶部附近有一个下拉菜单，默认情况下显示 `Convert Built-in to 2D (URP)` 。将此设置更改为 `Built-in to URP` 。窗口中的项目将会改变。
3. 向下滚动找到窗口的 `Material Upgrade` 部分，然后启用该部分。
4. 选择窗口底部的 `Initialize Converters` 。需要升级的材料列表将出现在材料升级部分。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20230807/learn/images/0671464c-a66e-4fc3-9b27-7192ea59c8bc_image.png.2000x0x1.png)
5. 选择窗口底部的 `Convert Assets` 按钮将材料更新为 URP。材料将从洋红色变成其预期的颜色和纹理。

此功能在使用通用渲染管道的 Unity 项目中可用。当您导入在另一个渲染管道中开发的资源包或将项目从不同的渲染管道转换为 URP 时，请记住此技巧。

> 提示：您也可以升级单一材料。在 Project 窗口中选择材质，然后转到主菜单并选择 `Edit > Rendering > Materials > Convert Selected Built-in Materials to URP` 。


### 4.观察默认材质

现在让我们开始创作一件艺术品。接下来，您将创建一个要在工作台上处理的新 3D 对象，以便可以向其应用材质。作为一个全新的 GameObject，它将拥有 `default material` 。

看一下新游戏对象上的材质：

1. 放置场景视图时，应确保工作台上有整洁的工作空间。
2. 在层次结构中，使用顶部的 `plus(+)` 按钮并选择 ` 3D Object > Sphere`（或其他原始形状）。
3. 在场景视图中，选择新的图元游戏对象并调整其位置，以便您可以清楚地看到它。
4. 在检查器窗口中，展开材质检查器。您将看到应用于新基元的材质名为 `Lit`  ，并且它正在使用 `Universal Render Pipeline/Lit Shader` 。这是通用 `Universal Render Pipeline` 的默认材质。

注意：此处的所有内容均呈灰色，因为此光照材质是着色器的默认材质。您无法编辑它（除非通过代码）。每当您创建新的游戏对象时，您都会看到此默认材质。

接下来，让我们用不同的材质替换默认材质。  


### 5.在 Project 窗口中查找材料

传统上，Unity 项目包含一个 **Material** 文件夹，您可以通过 Project 窗口访问该文件夹。但是，当您从资源商店或其他来源导入资源时，您还可以在其他地方导入其他材质文件夹。您可以执行一些操作来查找项目中的任何材料。您将需要这些技巧和技巧来找到您的艺术作品所需的材料。

**Favorites**

在 Project 窗口中，使用 Two Column layout 布局，选择 `Favorites > All Materials` 以查看项目中的所有材料。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/150b4b38-c724-4f55-aa67-bda2155720ff_CC_Shad_Mats1.png.2000x0x1.png)

当您选择此选项时，`t:Material` 将出现在 Project 窗口的搜索框中。使用 `t:` 进行搜索 `t: ` 表示资产类型。 （您可以通过输入 `t:Script` 使用它来搜索项目中的所有脚本。）暂时保持原样。

您可以选择 Project 窗口顶部的选项，将搜索范围缩小到 **In Packages** 、 **In Assets** （您的 **Assets** 文件夹）或选定文件夹中的材料。要仅查看项目中的材料，请选择 `In Assets`。

**Search**

在 Project 窗口的搜索栏中，将 `red` 添加到搜索中，使查询 `t:Material red` ，以查找名称中包含 `red` 的所有材料。

找到 `AppleRed` 。

### 6.将材质应用到游戏对象

尽管您已经将材质应用到游戏对象，但您可能有兴趣了解更多实现方法。下面列出了它们，以防您还没有找到您喜欢的那一个。

尝试通过以下每种方式应用材质：

1. 将材质从 Project 窗口拖动到“场景”视图中的对象。
2. 将材质从 Project 窗口拖至“检查器”窗口中“网格渲染器”组件的 **Materials** 属性。
3. 在检查器窗口中，使用对象选择器（圆形图标）打开一个对话框窗口，您可以在其中滚动或搜索材料并选择所需的材料。
4. 选择应用了所需材质的游戏对象，然后将该材质的缩略图从检查器窗口拖动到场景视图中的游戏对象。

将 `AppleRed` 材质应用到新的游戏对象，并将其应用到苹果。如果您愿意，可以将其应用到其他物体上！

> 注意：苹果 GameObjects 是具有名为 `AppleBody` 的子对象的父对象。 `AppleBody` 子对象将获取材质。

**一种材质，多种游戏对象**

在多个游戏对象上使用一种材质很方便。您可以节省时间并为游戏对象提供一致的外观。但是，请务必记住，材料是项目中存储的资产。当您更改一个游戏对象上的材质时，它会在使用该材质的每个游戏对象上发生更改！

此外，您可以在多个场景中的多个游戏对象上使用一种材质 - 并且一个场景中材质的更改将显示在每个场景中！

如果您不知道如何使用和组织材料，这可能会很麻烦。在下一步中，您将看到它的实际效果并了解如何管理它。

### 7.更换材质
改变 AppleRed 材质的颜色：

1. 确保您已将 AppleRed 材质应用到工作台上的多个对象。
2. 选择苹果（子对象AppleBody）并在 Inspector 窗口中查看 Material Inspector。
3. 找到 `Base Map` 属性，其中有一个颜色选择器。使用此颜色选择器更改 AppleRed 材质的颜色。其他具有这种材质的物体也会发生变化！

重要的是要记住，当您选择游戏对象并使用材质检查器时，您将更改使用它的所有地方的材质，而不仅仅是选定的游戏对象！

现在，选择一种新的苹果颜色——将其设为绿色 `Granny Smith` 或黄色 `Golden Delicious` 。

### 8.找到应用于游戏对象的材质
现在您已经更改了颜色，AppleRed 名称不再适合这种材质。接下来，您将在项目资产中找到该材料并更改其名称。

您可以使用场景视图在项目中查找材质：

1. 选择您的原始对象。
2. 在检查器中，找到网格渲染器组件的 `Materials` 子部分。
3. 找到应用 `AppleRed` 材质的元素并选择它。在 Project 窗口中，您将看到包含该材料的文件夹将打开，并且材料名称将突出显示。
4. 在 Project 窗口中，右键单击 AppleRed 材质，选择 `Rename`  ，然后为该材质指定一个描述其新颜色的名称。

### 9.创建新材质
现在您至少有两个（也许更多）相同颜色的对象，但是一个好的构图将具有多种颜色。
接下来，复制一个苹果并为其创建一个新材质：
1. 在场景视图中，选择一个苹果，然后按 `Ctrl+D` (Windows) 或 `Cmd + D` (macOS) 将其复制。
2. 将新苹果重新放置在工作台上的空白处。
3. 在 Project 窗口中，打开 `Assets > CreativeCore_Shaders > Materials` 文件夹，在此位置创建新材质。
4. 在 **Materials** 文件夹中，右键单击并选择 `Create > Material`
5. 将此材料命名为 `AppleRed 2`。
6. 使用 `Base Map` 属性  中的颜色选择器，选择在苹果上看起来不错的红色阴影。
7. 将这种材料应用到你的新苹果上。  

### 10.复制材质
更改一个对象而不是多个对象的外观的另一种方法是复制现有材质，将其应用到对象，然后更改副本。
通过复制新的 AppleRed 2 材质来创建新材质，为场景添加更多多样性：
1. 在场景视图中，选择新的红苹果（确保选择了父对象）。
2. `Ctrl/Cmd+D` 复制红苹果。
3. 移动新苹果，以便可以并排看到两个红苹果。现在您有两个使用相同材料的相同红苹果。
4. 在 Project 窗口中，返回 Materials 文件夹，选择 `AppleRed 2` 材质并使用 `Ctrl/Cmd + D` 复制它。
5. 将新材质重命名为 `Apple Light Red` 或选择其他名称来描述您喜欢的任何颜色。
6. 将种新材料应用到复制的苹果上。现在看来还是一样。  
7. 更改新材料的颜色。请注意，现在您的更改仅影响新苹果。

现在您有几个可以在静物构图中使用的苹果。每当您受到启发想要在构图中添加新对象时，请继续将它们移动到空的底座上。

## 模拟固体表面

材质定义了光在物体上的表现方式。
在本教程中，您将通过了解光与固体对象的关系来开始了解材质。在此过程中，您将为实体对象创建材质，并且能够模拟现实世界中的对象。

学完本教程后，您将能够：

- 解释镜面反射率和漫反射率
- 区分镜面反射和金属属性并解释如何配置它们
- 使用颜色调整材质的底图(Bash map)
- 应用镜面和金属工作流程以实现所需的效果
- 确定要在新材料中配置的现实世界表面的特征
- 调整材料属性以模拟给定的固体物质


使用这些图表作为现实设置的参考：

![image](https://docs.unity3d.com/uploads/Main/StandardShaderCalibrationChartMetallic.png)

![image](https://docs.unity3d.com/uploads/Main/StandardShaderCalibrationChartSpecular.png)

### 4.漫反射率：底图(base map)

现在您知道漫反射率意味着物体的可见颜色，即从其表面反射的颜色。

在 Unity 中，为了表示漫反射率，URP/Lit Shader 需要您已经使用过的 **Base Map** 。

其他着色器通常将此属性称为 Albedo 或 Diffuse Map（尽管从技术上讲，这些术语的含义并不完全相同）。

**什么是反照率？**

术语 `albedo` 描述了漫反射的测量。

它通常被指定为常规颜色，表示为红色、绿色和蓝色（RGB 值）的三个值。 

RGB 值可以转换为色调、饱和度和亮度（亮度）的值。

反照率颜色的亮度对应于漫反射的量，色调和饱和度描述从表面逸出的光的质量。

**为什么叫地图呢？**
我们很快将更详细地讨论 map 。

map可以是纯色，也可以用 2D 图像指定，以便为表面添加变化。

用于设置底图属性的颜色选择器仅将所选颜色应用为纯色。

### 5.高光工作流程中的金属

看看您现在在现实世界中可以看到的金属物体。这些可能包括一支笔、包或衣服上的铆钉，或者一些珠宝。您如何用镜面反射率和漫反射率来解释金属？这是一个棘手的问题，因为金属没有太多漫反射（如果有的话）！

如果场景中的苹果是苹果形状的钢制镇纸怎么办？它不再是红色——它的所有反射都是镜面反射，无论是直接来自光源还是间接来自环境。事实上，您会看到每个直接或间接光源都是整个表面上的镜面反射。

使表面看起来像金属的特性称为 **镜面反射(specularity)**。

当您可以看到物体中反射的光源时，您可以判断反射是镜面反射。对于银和钢等未染色的金属，我们看到的光具有照射到表面的光的颜色，就像镜子一样。

镜面反射度与平滑度不同。我们可以将红苹果打磨得非常光滑，但那样它永远不会变成金属。然而，要产生镜面反射，光滑的物体必须具有一定的镜面反射度。

下图中的苹果具有相同的平滑度，但镜面反射程度有所增加。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/0f9386fc-dcfe-42ab-bf95-7278dd8defe5_CC_Shad_Light3.png.2000x0x1.png)

与漫射表面一样，金属也会吸收光。

如果你把一个金属物体放在阳光下，你就能看出这是真的——它会变热！但在有色金属上，比如金和铜，我们看到的彩色光实际上不是漫反射——而是有色镜面反射。

它必须是镜面反射的，因为您可以在反射中看到光源。您看到的色调是由物体吸收部分可见光谱并仅反射色调颜色造成的。

**镜面工作流程**

镜面反射度作为材料的一种属性，是指定表面看起来具有金属质感的一种方法。

您可以使用两个 **workflows** 来指定材质中的金属外观。当您在 URP/Lit 着色器中使用 **Specularity** 属性时，您正在使用 **Specularity** 工作流程。 （接下来我们将解释另一个 **Metallic workflow** 流程。）

> Material -> Surface Options -> Workflow Mode

在镜面反射工作流程中，**Specularity** 设置大于 0 的平滑材质将产生一些镜面反射。  

在镜面工作流程中：
- 闪亮的金属具有高 **Specularity** 设置和高 **Smoothness**  设置。
- 闪亮的非金属具有低 **Specularity** 设置和高 **Smoothness** 设置。
- **Smoothness** 重点关注镜面反射，**Specular Map** 控制镜面反射的数量和颜色。
- **Specular Map** 可以使用 RGB 颜色。

让我们尝试一下苹果上的镜面反射。
1. 选择一个苹果并查看材质检查器。
2. 确保材质检查器中的工作流程模式属性设置为 **Specular** 。
3. 将 **Smoothness** 调整为值 1。
4. 将苹果的 **Specular Map** 颜色  更改为白色，以创建金属般的镜面效果。
   1. 注意苹果的漫反射颜色发生了什么（底图）。你的黄色金冠或绿色澳洲青苹果怎么了？在镜面反射工作流程中，随着镜面反射值增加（接近白色），基色（漫反射颜色）的量将被忽略。
5. 尝试 **Specular** 颜色，甚至将其从灰色更改为彩色。你可以获得一些奇怪的效果！请记住，您正在使用两种类型的反射光：使用 Bash Map 的漫反射光，以及使用 Specular map 的镜面反射光。在这里，您可以选择为这两种反射类型提供不同的颜色。由此产生的效果在现实世界中是不寻常的，但并非闻所未闻。 （例如，考虑蓝光下的金属红色汽车。）
6. 完成实验后，设置镜面反射颜色以创建一个由金色制成的苹果。在本例中，您将模拟金色镜面反射黄色光并吸收所有其他颜色的方式。


### 6.金属工作流程中的金属

Unity 提供了两种使对象看起来具有金属质感的方法。您一直在使用的镜面工作流程是两者中更科学的一个。**Metallic workflow** 更简单，但不严格遵循物理光规则。

**Metallic workflow** 中的底图颜色在具有高金属设置的对象中仍然可见。将上面的镜面工作流程中的苹果与下面的**Metallic workflow** 中的苹果进行比较。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/f611af4d-e29e-4e9e-aabb-4f17991a643c_CC_Shad_Light4.png.2000x0x1.png)

在金属工作流程中：
- 闪亮金属具有高 **Metallic** 设置和高 **Smoothness** 设置。
- 有光泽的非金属具有零或较低的 **Metallic** 和较高的 **Smoothness** 。
- **Smoothness** 控制镜面反射的焦点。
- **Metallic Map** 仅使用灰度。

这是一个比较两者的表格：

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/0039d601-b409-45f6-9c0d-b22a2ef0d907_CC_Shad_Light5.png.2000x0x1.png)

在新苹果上尝试 **Metallic** 工作流程：
1. 选择一个苹果并在检查器中查看它。如果材料部分尚未打开，请打开它。
2. 打开 **Specular Map** 的颜色选择器。记下您在上一步中选择的颜色的十六进制代码；例如：`#ECCC15` 。
3. 复制苹果对象，以便底座上有两个苹果。
4. 创建一个新材质并将其应用到第二个苹果上。  
5. 将第二个苹果材质的工作流程模式  设置为 **Metallic** 。
6. 使用颜色选择器将底图颜色设置为您记下的颜色。
在金属工作流程中，底图颜色严格来说并不是漫反射颜色 - 无论表面是否纯金属，它都保持可见。这称为金属度，而不是镜面反射。
7. 尝试平滑度和金属度值，直到两个苹果尽可能匹配。
   请注意，与镜面反射贴图不同，金属属性不使用颜色，但有一个滑块。它始终表示为单个值（灰度），而不是三个值（RGB 颜色）。它只是表示金属量。
   
   无论金属色的值低还是高，所有反射光（代表镜面反射和漫反射）都会保留基色。

**您应该使用哪个工作流程？**

当您导入资源时，您会看到一些资源使用镜面工作流程，而其他资源则使用金属工作流程。

当你有选择的时候，你可以使用你喜欢的任何一个。

金属工作流程更常见，因为它更容易使用，但它并不那么科学。

高光工作流程基于现实世界的反射率原理，但彩色高光贴图使其更具挑战性。


### 7.平滑度
在你自己的世界中观察纯色材料：塑料、纸张、陶瓷。注意镜面高光。它们是模糊的还是聚焦的？你能在反射中看到光源吗？关于每个物体的光滑度或粗糙度，这告诉你什么？

现在考虑一下工作台上的苹果。它们的镜面反射是模糊的高光，这告诉我们它们的表面有点粗糙。但如果我们对苹果进行抛光，使表面更加光滑，我们就可以看到表面反射的光源形状。

**Smoothness**，也称为 **gloss** 或 **glossiness** ，使镜面反射成为焦点。在光滑的表面上，光会以均匀的方式反射，这样您就可以在反射中看到光源的形状。

从粗糙的表面来看，仍然存在镜面反射，但它是散射的。苹果各处的小表面都会发出镜面反射。

平滑度会增加镜面反射，但重要的是不要混淆两者。高镜面反射度使物体看起来像金属。表面可以非常光滑，就像我们抛光的红苹果一样，但看起来仍然不像金属。

在下图中，所有五个苹果的金属设置均为 0.5，平滑度不断增加。在最光滑的一张上，我们可以看到桌子的灯光和反射。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/44fb8267-f2b2-47ab-ac6c-16df97355fd1_CC_Shad_Light6.png.2000x0x1.png)

**探索平滑度**

在 URP/Lit Shader 中，您可以使用一个值设置整个表面的平滑度。 （我们很快就会讨论其他选项。）
1. 通过调整 **Smoothness**，来试验苹果的平滑度。
2. 移动或旋转苹果并注意其不同平滑度的镜面反射。
3. 平滑度、镜面度或金属度实验：
   - 当您的金属工作流程苹果的平滑度为 1，但金属设置为 0 时，会发生什么情况？
   - 当您的镜面工作流程苹果的平滑度为 1，但镜面贴图为 0（黑色）时，会发生什么情况？

当您使用导入到 Unity 中的模型时，您将遇到这两个工作流程中的所有设置组合。了解每个工作流程后，您将能够在每个工作流程中工作以获得您想要的结果。


### 8.探索：创建固体材料
现在您已经了解了基于物理的材质的几个关键概念：漫反射率、镜面反射率和平滑度。您知道平滑度和金属度/镜面度之间的区别，并且可以使用镜面和金属工作流程。

是时候进行一个小挑战了：模拟真实世界的材质。

1. 在现实世界中找到一个纯色物体。它可能由纸、塑料、金属或涂漆的东西制成。寻找具有均匀颜色和物理纹理的东西。
2. 创建一个带有曲线的新基元（最好是球体、胶囊或圆柱体），以便您可以轻松看到镜面反射。
3. 在Materials文件夹中创建一个新材料。  
4. 将新材料应用到您的画廊作品中。  
5. 在 Unity 中复制真实世界材质的外观。

> 提示：在现实世界中，尝试将现实世界的对象放在类似于我们图库中的聚光灯的灯光下，以便您可以比较镜面反射和漫反射。

如果您能够以一种看起来令人信服的方式模拟现实世界的物体，您就会成功。

有关显示各种材质中的镜面和金属工作流程的详细插图，请查看 Unity 手册中的这些材质图表。

如果您不能完全做到这一点，请不要担心 - 在接下来的教程中，有更多基于物理的材料的属性和技术可以为您提供帮助。现在重要的是您知道如何应用这些属性来使 Unity 中的对象看起来真实。


## 贴图(Map)材质与纹理
纹理是环绕 3D 对象以创建颜色、反射率和其他属性变化的 2D 贴图。在本教程中，您将了解纹理的工作原理，并开始使用材质将它们应用到对象上。

学完本教程后，您将能够：

- 定义材质中使用的纹理和贴图
- 解释可在 URP/Lit Shader 上配置的贴图及其各种效果
- 定义 UV
- 解释如何使用 3D 建模程序为 Unity 材质创建资源
- 使用图像调整材质的底图
- 给定一组纹理文件，选择适当的贴图来模拟材质


> 如果您的商品没有纯色怎么办？如果它是圆点、条纹或斑点怎么办？如果它有缺陷，如划痕或腐蚀怎么办？

大多数现实世界的物体不具有均匀的反射率和平滑度。这就是贴图的用武之地。贴图是 2D 图像，它像一张纸一样包裹着游戏对象，用于设置整个网格的颜色、镜面反射度或金属度、物理纹理以及其他属性。`包含贴图的图像文件称为纹理`。

### 2.什么是纹理？
纹理是您可能熟悉的格式的常规图像文件，例如 BMP、TIF、PNG 和 JPG。

图像文件中的数据被组织成通道。黑白图像，也称为灰度图像，只有一个通道来指示每个像素中的灰色阴影。彩色图像需要三个通道：红色、绿色和蓝色 (RGB)，它们结合起来创建您在计算机显示屏上看到的颜色。  

某些图像文件格式有四个通道：红色、绿色、蓝色和 Alpha (RGBA)。 Alpha 通道通常包含透明度数据。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/05b52588-1daf-489e-a26e-7aa449f88dd6_CC_Shad_Text_A.jpg.2000x0x1.jpg)

图像文件的每个通道本身就是一个数字矩阵。在材质中，这些数字可以指示除颜色或透明度之外的其他属性（例如平滑度、镜面反射度或金属度），甚至每个像素所面向的方向以创建物理特征的外观。

**纹理文件的来源**
艺术家通常在 3D 建模软件（例如 Blender® 和 Adob​​e® Substance 3D Painter®）中创建纹理及其模型。将网格和纹理导入 Unity 后，他们使用纹理来创建材质。

您可以从 Unity Asset Store 获取包含纹理文件的材质，这些材质可以作为单独的、可立即应用的材质，也可以包含在模型中。

此外，常规的 2D 图像也可以变成纹理。您甚至可以拍摄现实世界中的表面照片来构建您自己的纹理！如果您在互联网上搜索要使用的图像，请确保您知道如何负责任地使用其他人的数据。

### 3.检查纹理文件

仔细看看一些纹理文件：
1. 在 Project 窗口中，打开 `Assets > CreativeCore_Shaders > Textures > Tiled Textures` 文件夹。
2. 选择 `Plastic_Albedo` 文件。这是一个 TIF 文件。
3. 在检查器中。找到图像的缩略图及其上方的工具栏。选择 `R 、G 、B` 和 `A` 按钮查看这些通道。这对于检查文件是灰度（单通道黑白）、三通道 RGB 还是四通道 RGBA 非常有用。
4. 要更仔细地查看，请在 Project 窗口中双击纹理文件，它将启动该文件格式的默认程序，例如 Adob​​e® Photoshop® 或照片查看器。

### 4.使用底图纹理更改颜色

`Base map texture`（也称为漫反射(diffuse)或反照率(albedo)）是一种常规 RGB 或 RGBA 彩色图像文件，用于定义对象表面的漫反射（即颜色）。

底图还可以在地图的 Alpha 通道中包含透明度信息。 （稍后我们将尝试透明度。）

1. 要试验某些纹理，请返回工作台并找到要更改的材质，或创建要使用的新材质。

2. 在 Project 窗口的 `Assets > CreativeCore_Shaders > Textures > Tiled Textures` 文件夹中，确定要应用于材质的 `Base Map` 属性的纹理。它们的名称中会有反照率、漫反射或基础等词。

3. 使用以下方法之一  将这些纹理中的任何一个应用到材质的底图：
   - 将纹理从 Project 窗口拖到材质的 `Base Map` 属性左侧的空框中。
   - 选择圆圈图标可查看项目中可用作底图的所有文件。
     - 注意：要清除底图，请选择圆圈图标并选择 `None` 。  

4. 在您​​的对象上尝试其他底图，并在工作台上的灯光下检查它们。

5. 尝试使用颜色选择器设置基色来为底图纹理着色。**通常您会希望此颜色为白色**，这样就不会改变纹理颜色，但有时着色可能很有用。

### 5.平铺纹理(Tiled textures)
`平铺纹理(Tiled textures)` 文件夹中的纹理设计为平铺在任何网格周围。每个文件中的地图就像地板上的瓷砖一样简单地重复。

在 Unity Asset Store 中，您将看到无缝(seamless)纹理包 - 这些纹理被设计为平铺，平铺之间不会出现任何接缝。

继续尝试将不同的底图应用到工作台上的项目。当您这样做时，请随意调整材质检查器中的平铺和偏移属性。

注意：平铺和偏移设置适用于网格上的所有贴图。
- **平铺(Tiling)** 是网格表面上每单位的平铺数量。数字越大，图案越小。
- **Offset** 在不同的点开始平铺。例如，X 偏移为 0.5 时，平铺偏移纹理宽度的一半。


### 6.UV贴图纹理

对于诸如球体之类的基元和像我们的块这样的简单形状，纹理贴图在哪些点与对象的网格对齐并不重要。

观察画廊远处角落里的艾伦角色。她的身体表面有皮肤、织物、皮革和金属——但这些都是同一种材料！您可以在 Ellen 旁边的纹理展示中看到该材质的底图纹理。

该纹理环绕她身体的网格，以创建您在模型上看到的颜色。在角色模型和像 Ellen 这样的详细对象模型上，纹理贴图与网格的对齐非常重要！

**纹理如何包裹网格？**

在建模应用程序中创建 3D 模型时，应用程序会使用称为 `UV mapping` 的过程生成这些纹理。

由建模应用程序（例如 Autodesk® 3ds Max® 和 Maya® 或 Blender®）创建的网格会生成自己的一组 2D 坐标（称为 `UV coordinates` ）。 

UV 坐标类似于常规 2D 空间中的 XY 坐标，但称为 UV 是为了与环境坐标系 (XYZ) 区分开来。 UV 坐标相对于网格，而不是场景中的 3D 空间。

**UV 贴图是展开 3D 模型表面以创建平坦表面，然后对其应用 2D 纹理贴图的过程**。在此过程中，建模应用程序会生成 UV 坐标，使纹理能够重新包裹到模型上。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/7b0e005e-a171-4abf-947f-fcf0eb5f6f5f_EllenUnwrap.gif._gif_.mp4)

建模可以产生复杂的物体，就像我们的角色艾伦一样。 Ellen 由多个网格（称为子网格）组成，每个网格都有自己的材质。但艾伦只有几个子网格——从脖子以下的所有东西都是一个子网格，需要一种材料。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/fced201b-d982-49c6-87c9-eb0fa341ca6b_CC_Shad_Text3.png.2000x0x1.png)

`UV mapping` 允许艺术家对其对象的表面进行建模，而无需使用大量网格数据或单独的纹理来提供细节。


### 8.将纹理与模型相匹配

这是一个练习，可帮助您熟悉镜面/金属和平滑度值的纹理贴图。因为这些纹理对应的属性并不总是很容易看到，所以它们并不容易识别！

1.  在场景视图中，找到工作台上的水壶。
2.  在 Project 窗口的 `Materials` 文件夹中，创建一个新材质并将其应用到水壶。将其命名为 `Kettle` 。
3.  在 `Textures` 文件夹中，找到一个名为 `Kettle` 的子文件夹，其中包含一系列纹理文件。
4.  使用检查器检查这些纹理。请记住使用 `R 、G 、B` 以及有时使用 `A` 按钮查看每个通道。
5.  根据您对纹理和材料属性的了解，确定将为该水壶提供基色、镜面或金属品质以及平滑度的贴图。 （弄清楚您将使用哪个工作流程：镜面或金属。）
   以下是解决这个难题的一些技巧：
   - 您将仅使用标记为 `Kettle_A` 到 `Kettle_F` 的两个文件。
   - 请记住，较浅的颜色是高值，较深的颜色是较低值。例如，平滑度贴图上的白色区域是最平滑的。
   - 请记住，镜面工作流程使用三个颜色通道，而金属工作流程仅使用 R。

当您的水壶如下图所示时，您就成功了。如果您需要一些帮助，答案就在本教程的最后一步(用一个 material,  Metallic -> Base Map(Kettle E), Metallic Map(Kettle B))。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/5a2f0c2b-99b1-4845-98c2-caf05315ccca_CC_Shad_Text4.png.2000x0x1.png)

这个练习可能看起来像一个简单的匹配游戏，但它是一项重要技能的实际练习：识别纹理并正确应用它们来组装导入的材料。这是技术美术人员经常做的任务。当您收集使用各种建模应用程序构建的模型和纹理时，您会遇到更多像这个水壶这样的谜题


## 创建半透明和透明效果

光不仅会从物体上反射，有时还会穿过物体。在本教程中，您将使用透明度创建一个看起来像玻璃的半透明对象，并使用 Alpha 剪切技术从简单的矩形网格创建逼真的叶子。

学完本教程后，您将能够：

- 应用更多可在 URP/Lit Shader 上配置的贴图
- 在材质中应用 Alpha 裁剪
- 将透明表面类型应用于材质

着色器可以做的许多奇妙的事情之一就是与网格本身一起渲染网格另一侧的任何内容，甚至代替网格本身。着色器可以通过向透明网格添加镜面反射和一点点色调来创建玻璃或其他透明物质的外观。

在本教程中，您将学习如何向材质添加透明和半透明效果。为此，您需要在画廊中添加一个装有一些绿色植物的玻璃罐。您将使用称为 `alpha 裁剪(alpha clipping)` 的过程从非常简单的网格创建详细的叶子。

### 2. Alpha 通道的透明度
透明度由底图的 Alpha 通道（RGBA 中的 A）控制。

较低的值会使底图颜色不太明显，而较高的值会使其更加明显。

您可以通过将 Alpha 通道值设置为零来使网格完全不可见，也可以通过将 Alpha 值设置在中间范围来创建半透明效果。


### 3.创建玻璃材质
鉴于您对镜面反射率和漫反射率的了解，您会如何描述半透明物体，例如玻璃罐？它的镜面反射是什么？它的漫反射是什么？

一块完全透明且平坦的玻璃板没有漫反射——所有的光都穿过它，并且没有任何颜色反射回您的眼睛。然而，它确实具有镜面反射——光线在其光滑的表面上闪烁。现实世界中的玻璃很少是完全透明的。它有色调和一些缺陷，会产生轻微的漫反射。    

在现实世界中，半透明物质会折射光线，这意味着它们会改变光线的方向。折射是一种高级着色器效果，我们在这里不会尝试；然而，我们可以创建一个看起来非常令人信服的半透明玻璃物体。  

让我们从一个简单的物体开始，把它变成玻璃。

1. 在场景视图中的工作台上，寻找一个里面有一根棍子的白色罐子。棍子上看起来像是贴着一些小纸片。
2. 在 Project 窗口中，打开 `Materials` 文件夹并创建一个新材质。将其命名为 `Glass Jar` 。
3. 在层次结构中，找到 `PlantInJar` GameObject，它有很多子对象。选择子对象 `Jar` 。
4. 将新的 `Glass Jar` 材质应用到 `Jar` 子对象。
5. 在检查器中的 `Glass Jar` 材质上，找到 `Surface Options` （位于 **Materials** 部分的顶部）和 `Surface Type` 属性。将此值从 `Opaque` 更改为 `Transparent` 。
   罐子的前半部分消失了！它看起来像一个剪纸。这是由于 `Render Face` 设置而发生的。`Render Face` 通常设置为 `Front` ，因为着色器只需要渲染面向观察者的网格物体表面。然而，对于透明物体，着色器需要渲染正面和背面。
6. 将  `Render Face` 设置为 `Both` 。
   - 这个 `jar` 看起来仍然很奇怪，因为我们给它的指令是相互冲突的：`Surface Type` 是透明的，但 alpha 通道仍然具有默认值，这表明没有透明度。

7. 要调整 Alpha 通道值，请选择 `Base Map` 的颜色选择器。默认情况下，`A` 通道设置为最高值 255，不允许透明度。使用滑块或输入小于 255 的数字，使透明度达到使罐子看起来像玻璃的水平。 （小心——在 0 时，它是完全不可见的！）
8. 当您在颜色选择器中时，您可以将基色更改为蓝色或绿蓝色色调以模拟真实的玻璃罐。
9. 缺少什么？镜面反射！将 `Smoothness` 和 `Metallic` 属性设置为您认为合适的值。给它一点 `Metallic` ，即使它不是金属，以增强镜面反射。
    
你创造了玻璃！你的罐子应该如下所示。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/68176252-e714-4788-894a-dfb30dba9adb_PlantInJarGlassOnly.png.2000x0x1.png)

### 4.通过 Alpha 剪切添加细节
考虑一个如下所示的对象。这是一个简单的对象，建模艺术家可以通过制作叶形网格来创建。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/f3a6bfa6-c91f-408d-8a38-c1dc1f547752_Leaf.png.2000x0x1.png)

然而，对于场景中很小、甚至可能被使用数千次的对象（例如在树中），该叶子的网格将需要大量的计算能力来渲染。

艺术家不是对此类项目的网格进行建模，而是在纹理中**使用 alpha剪切 来使简单网格的一部分不可见**。 Alpha 剪切是创建详细对象的一种更有效的方法 - 它更容易创建并且更容易让计算机在运行时处理。

棍子上的那些小纸片将会变成叶子！对这些叶子的材质应用 alpha 剪切：

1. 在 Project 窗口中，打开 **Materials** 文件夹并创建一个新材质。将其命名为“叶”。

2. 在层次结构中，展开 `PlantInJar` GameObject 并找到名称中包含 `Leaf` 的 子 GameObject。选择所有叶子和 `PlantStem` 。

3. 在 Inspector 的 Mesh Renderer 组件中，您可以使用 `Materials` 下的圆圈图标为所有选定的 GameObjects 选择一种材质。选择 `Leaf` 。
现在，您只需选择一片叶子即可在所有叶子上编辑此材质。

4. 从各个角度检查植物。从顶部可以看到叶子，但从底部看不到！发生这种情况是因为这些网格是单面的：对象背面没有单独的网格（例如立方体）。

5. 在 Inspector 中的 Leaf 材质上，将 `Render Face` 更改为 `Both` 以使着色器渲染每个网格的两侧。

6. 在 Project 窗口中，通过搜索找到纹理 `Plant_Albedo` 。将此纹理应用为叶子材质中的 `Bash Map` 。
   茎现在是实心的。仔细观察纹理，您会看到左侧有一条绿色条纹，它仅映射到 `PlantStem` 对象，而纹理的其余部分则映射到 `Leaf` 子对象。在一个纹理上映射多个对象是艺术家用来减少项目文件数量和总体文件大小的一种技术。

   现在叶子看起来就像纸上的叶子打印件！您可以通过 Alpha 裁剪来解决这个问题。

7. 在检查器中，检查 `Plant_Albedo` 纹理  的 Alpha 通道。这是叶子的剪纸。我们将使用这个 Alpha 通道来“剪掉”该材质中的叶子。

8. 在场景视图中，选择 Leaf 材质并找到材质检查器顶部的 `Surface Options` 部分，然后启用 `Alpha Clipping` 。

9. 出现 `Threshold` 滑块。仔细检查叶子时，移动此滑块。在某个阈值下，叶子周围的“纸”将会消失。

10. 调整该值，使叶子的边缘看起来正确。如果阈值太低，则 Alpha 通道值较低的像素将可见，并且会出现白色边缘。如果太高，则一些较高的 Alpha 通道值将不可见，从而切断太近的边缘并导致一些孔洞。  
这件作品已经完成了。它应该如下图所示。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/f63ac1f4-9373-4e03-bd19-e65c0ad10b4d_PlantInJar.png.2000x0x1.png)

您以两种方式使用透明效果：使用透明表面类型使整个罐子对象透明，以及使用 Alpha 剪切使植物上的叶子部分透明。做得好！


### 5.探索透明效果

您还能用这些新技术为您的最终艺术作品做些什么？自行探索这些技术：

**更多 Alpha 剪裁**

`Textures > Tiled Textures` 文件夹中的 `ChainFence_Albedo` 纹理是另一种专为 Alpha 剪切而设计的纹理。尝试使用此纹理，或寻找 Alpha 通道中具有 0 值（黑色）的其他纹理来剪切网格的部分内容。

透明度

在透明对象（如玻璃罐）中，底图 Alpha 通道的变化可以创建半透明效果。尝试在表面类型为透明的对象上使用 Alpha 通道中的值不全黑或全白的底图纹理，例如 `Textures > Tiled Textures` 文件夹中的 `Plastic_Albedo` 。找到其他具有 Alpha 通道变化的纹理并进行实验！

制作自己的透明效果

如果您有图像编辑工具，请编辑纹理文件的 Alpha 通道，并使用 Alpha 剪切和透明度从工作台上的图元或对象创建一些详细的对象。


## 使用凹凸贴图(bump mapping)添加物理纹理
纹理通常用于将物理纹理的外观添加到网格表面，而不更改网格本身。在本教程中，您将了解凹凸贴图如何为表面添加浮雕效果。

学完本教程后，您将能够：

- 应用更多可在 URP/Lit Shader 上配置的贴图
- 将法线贴图和高度贴图添加到材质中。

除了我们到目前为止介绍的属性之外，基于物理的着色器的材质还允许您将物理纹理的幻觉添加到简单的网格中，而无需使用大量详细的多边形使其复杂化。使用纹理添加此细节的过程称为 `凹凸贴图(bump mapping)` 。这个过程比在网格上建模小细节要高效得多。

在本教程中，您将了解帮助着色器向网格添加物理细节的贴图。

### 2.什么是凹凸贴图？

考虑低多边形网格（多边形较少的网格）和高多边形网格之间的差异。渲染高多边形网格需要更多的计算能力，因为更多的多边形意味着有更多的数据需要处理。
但通过凹凸贴图，您可以告诉着色器将表面细节的外观添加到网格中，而无需实际添加多边形。这种技术的性能更好，而且结果非常令人信服！

[Unity 手册对凹凸贴图进行了精彩的图文解释](https://docs.unity3d.com/Manual/StandardShaderMaterialParameterNormalMap.html)

凹凸贴图主要使用两种类型的贴图：**法线贴图(Normal Maps)**和 **高度贴图(height maps)**。

您可能还记得，**法线是网格数据中的值**，用于定义每个顶点所面向的方向。法线贴图在整个表面上设置这些值，这指示着色器创建表面上的片段（像素）面向不同方向的错觉。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/1a10eda3-f94b-463c-a9ce-1e44c1226691_Copy_of_CC_Shad_Mesh_5.png.2000x0x1.png)

**高度图** 表示每个像素距网格的相对高度。

法线图和高度图可以在不使用太多计算能力的情况下向表面添加真实的物理细节。通常，使用法线贴图而不使用高度贴图。

### 3.使用法线贴图添加表面细节

与底图和镜面/金属贴图一样，法线贴图是在 3D 建模或绘画软件中创建的。您甚至可以从 Unity Asset Store 下载可平铺的法线贴图！

法线贴图与底图类似，不同之处在于红色、绿色和蓝色值指示法线相对于网格表面的方向。**法线贴图主要是青色和紫色**，因为方向是使用蓝色通道中较高的值表示的。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/5d4b3249-c40a-42dd-9232-5a66e331e9b6_CC_Shad_Bump_1.png.2000x0x1.png)

在我们的纹理展示中，观察 Ellen 身体的法线贴图，并将法线与底图和 3D 模型进行比较。
要查看带有和不带有法线贴图的 Ellen：

1. 在场景视图中，放大 Ellen 的脸部。

2. 在层次结构中，找到 Ellen GameObject，然后选择 `Ellen_Body` 子对象。

3. 在检查器中，打开 `Ellen_Body` 材质。

4. 在 `material` 中  找到 `Normal Map` 属性。选择圆形图标以调出纹理选择器，然后滚动到顶部以选择None 。请注意艾伦的五官显得平坦且细节较少。

5. 在观看 Ellen 时，按 `Ctrl/Cmd + Z` 撤消删除法线贴图。按 `Ctrl/Cmd + Y` 和 `Ctrl/Cmd + Shift + Z` 切换法线贴图。查找法线贴图添加到艾伦制服的皮革和织物以及金属背心上的脊线的细节。

您还可以将没有法线贴图的网格线框视图与带有法线贴图的着色视图进行比较，以了解法线贴图如何向网格添加细节。

### 4.使用高度图添加浮雕

高度图表示每个像素距网格的相对高度。

这些是单通道（灰度）图，其中每个像素值表示距网格表面的相对距离。

当您使用 RGB 图像作为高度图时，着色器仅读取绿色通道。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211122/learn/images/879c1634-f637-4799-9db3-c157caf826c6_HeightMap_Pavement_TinyMoss_height.png.2000x0x1.png)

高度图不像法线贴图那样常用。它们对于创建戏剧性效果很有用，但它们也会拉伸底图，如果底图不是纯色，这通常是不可取的。

要试验高度图：

1. 在工作台上找到一个对象进行实验，或创建一个新的基元。
2. 创建一个新材质并将其命名为 `Pavement` 。
3. 打开 `Textures > Tiled Textures` 文件夹，找到名称中带有 `Pavement` 的纹理文件。
4. 应用 `Base Map`（反照率）、 `Metallic Map` 、`Normal Map` 和 `Height Map` 的纹理。
5. 滑块和数字字段将出现在 `Height Map` 属性处。调整 `Height Map` 值以查看效果。


## 使用更多纹理贴图细化表面

一旦熟悉了 URP/Lit 着色器的基本属性，您就会知道如何使用作为 3D 创建者会遇到的许多着色器、材质和纹理。本教程将完成您对该着色器的了解。

学完本教程后，您将能够：

- 解释 URP/Lit 着色器的详细输入的使用
- 解释高动态范围颜色

在本教程中，我们将向您展示这些其他类型的纹理，并让您自行将它们应用到图库中的作品。然后，您将通过创造性的挑战来测试您的知识。


### 2.使用遮挡贴图(occlusion maps)强化阴影

在 3D 图形中，`遮挡(Occlusion)` 是指物体对光线的阻挡。人行道上的裂缝和紧握的拳头手指之间的细暗阴影线都是遮挡的例子。

即使在 PBR 中，环境光也会以奇怪的方式反射到应该被遮挡的地方。 `遮挡贴图(occlusion map)` 向这些遮挡区域添加阴影。

遮挡贴图与 3D 建模软件中的大多数模型一起生成。这些效果有时很微妙，但它们使表面上的光线更加真实，并且可以以底图和凹凸贴图无法做到的方式增强详细的阴影。

对于 Ellen 的模型，遮挡贴图显示在纹理展示中。它是一个灰度（单通道）贴图，仅指示光和阴影，从
右侧数第二个。

要查看遮挡贴图的效果：

1. 在层次结构中，找到 `Ellen` GameObject 并选择 `Ellen_Body` 子对象。在层次结构中双击它即可放大。
2. 调整视角，仔细观察模特正面的艾伦衣领。
3. 在检查器中，找到 `Ellen_Body` 材质并展开其材质检查器。
4. 将遮挡贴图从 1  调整到 0，然后再调整回来，以查看遮挡贴图的效果。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/f9a88d17-6c7f-4a6d-b95e-71c05cc94fde_CC_Shad_Ref_1.png.2000x0x1.png)

如果没有遮挡贴图，艾伦衣领两侧就没有阴影，这使得该区域看起来很平坦。事实上，在没有遮挡图的情况下，近距离看起来好像有光从她的脖子后面射过来。有了额外的阴影，衣领看起来更圆，阴影看起来她的衣领和背心是两个不同的对象（即使在这个模型上它们是一个）。

现在轮到您应用遮挡贴图了。在工作台上，返回水壶。打开 `Textures > Kettle` 文件夹并尝试识别遮挡贴图。将其应用到水壶上并比较有和没有遮挡贴图的效果。


### 3.使用微表面贴图(microsurface maps)添加细节

仔细观察现实世界中具有光滑表面的物体，例如智能手机上布满指纹的玻璃，或者您最喜欢的已被划伤和磨损的咖啡杯。如果您想要对**这些项目进行建模并包含指纹或划痕**等细节，则可以使用微表面贴图来添加底图或法线贴图中未捕获的细节级别。

研究艾伦的微表面图：

1. 放大 Ellen 的脸。
2. 在层次结构中，选择 `Ellen > Ellen_Body` 对象。
3. 在检查器中，打开 `Ellen_Head` 材质检查器。
4. 在 `Detail Inputs` 部分（位于您一直工作的 `Surface Inputs` 部分下方），找到 `Normal Map` 。调整滑块以查看该贴图在艾伦皮肤上的效果。这是一个在常规法线贴图之上工作的平铺纹理。
5. 比较材质的 `Surface Inputs` 和 `Detail Inputs` 部分  中使用的两个法线贴图，您将看到这两个贴图如何协同工作以创建非常详细的效果。为此，请在材质检查器中选择它们的缩略图，以在项目窗口中查找纹理文件。

URP/Lit Shader 材质的“细节输入”部分中有两个附加纹理：
- `Detail Inputs Base Map` 可以添加细节颜色，例如织物中的线。
- `Mask` 是一个 Alpha 通道贴图，可将指定区域与底贴图和法线贴图微表面贴图屏蔽开。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/f4a34651-9aeb-4c68-a300-2b5167f848f8_CC_Shad_Ref_2.png.2000x0x1.png)

### 4.使用发射贴图(emission maps)照亮表面

发光(Emissive)材质似乎会发出自己的光。您可以使用 **emission maps** 来指定表面发光的区域。

观察我们画廊的纹理展览中展示的艾伦的发射图。它大部分是黑色的，但仔细观察，你会看到三个绿点。这张地图上的点与艾伦脖子后面和机器人手臂顶部的灯对齐。

地图上的颜色会影响灯光的颜色。此外，HDR颜色选择器使发射贴图的非黑色区域发出彩色光。

HDR代表 **高动态范围（high dynamic range）** 。 HDR 颜色在常规显示颜色范围之外具有额外的亮度。这些对于发光物体和强烈的镜面反射很有用。 HDR 颜色选择器有一个强度滑块，用于控制向颜色添加多少额外的亮度。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/ffd0fb01-33f1-49f3-a1a1-eb00a6d71628_CC_Shad_Ref_3.png.2000x0x1.png)

## 开始使用 Shader Graph

既然您已经了解了着色的基础知识，您就拥有了更进一步的知识 - 创建您自己的着色器。借助 Shader Graph，您可以轻松应用您的知识来创建令人兴奋的新效果。

学完本教程后，您将能够：

解释 Shader Graph 及其用途
- 在 Shader Graph 中创建一个新着色器
- 在 Shader Graph 编辑器窗口中导航
- 连接常用的 Shader Graph 节点以创建所需的效果
- 制作具有可配置材质属性的着色器
- 从自定义 Shader Graph 着色器制作材质

您可以使用着色器和材质创建许多有趣的效果，并且不限于 Unity 提供的着色器。着色器是如果您了解编码语言就可以操作的脚本。尽管学习该语言超出了这些教程的范围，但有一个工具可以使着色器编码变得更容易：Shader Graph。

Shader Graph允许您创建专门的着色​​器，而无需编写代码。特别是，您可以组合纹理并使其在片段着色器中移动，甚至可以更改顶点着色器中的顶点位置。专业的技术艺术家创建自定义着色器来实现专门的艺术风格并创建复杂的物质，如流动的熔岩、风暴云和植被。可能性几乎是无限的！

在本教程中，您将创建一个新的着色器，其视觉效果是您一直使用的 URP/Lit 着色器无法实现的。像专业技术艺术家一样，您将开发此自定义着色器，以便其他艺术家（包括您自己）可以用它创建材质。  

完成后，您将拥有用于艺术创作的有趣的新材质，并且您将获得更多自定义着色器的新想法。

### 2.打开Shader Graph

Shader Graph，顾名思义，可以帮助您使用类似流程图的图表来构建着色器。创建图表时，您可以实时查看着色器的默认材质，这使您可以轻松进行实验。
看一下您将要构建的着色器的原型。画廊里陈列着两件作品，位于艾伦对面的底座上。要检查此着色器的着色器图：

1. 在“项目”窗口中，导航至 `Assets > CreativeCore_Shaders > ShaderGraphs` 文件夹。在此文件夹中，您将看到四个资源：两个材质和两个使用 Shader Graph 创建的着色器。
2. 双击 `Example_Shimmer` 着色器资源将其打开。 Shader Graph 窗口将打开，您将看到该图表。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/7efc2130-4ce3-4d51-be6f-f3498a5063ab_CC_Shad_SG_2_1.jpg.2000x0x1.jpg)

**着色器图表窗口**

如果您愿意，可以打开已完成的 Shader Graph 着色器（如上所示）并随时参考。您将从新的空白 Shader Graph 窗口启动自己的着色器：

1. 在项目窗口的 `Assets > CreativeCore_Shaders > ShaderGraphs` 文件夹中，右键单击并选择 `Create > Shader Graph > URP > Lit Shader Graph` 。这将在文件夹中创建一个新的 URP 着色器。
2. 将新着色器命名为 `Shimmer_ShaderGraph` 或任何您喜欢的名称。
3. 双击着色器以在新的 `Shader Graph window` 中将其打开。
    1. 当您检查 `Shader Graph window` 窗口时，您将看到创建着色器时将使用的以下功能：
    2. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/e490d65c-a67a-4aa9-a155-9f534e5bf047_CC_Shad_SG_2_2.jpg.2000x0x1.jpg)
        1. `Shader Graph toolbar (1)` 是您保存着色器资源的位置。
        2. `Blackboard (2)` 包含使用此着色器创建材质的艺术家可用的属性。您可以在此处定义属性类型及其名称、属性和默认值。
        3. 您将在 `workspace (3)` 中创建着色器的节点图。
        4. `Main Preview Window (4)` 将为您提供着色器外观及其行为方式的实时更新。
        5. `Graph Inspector Window (5)` 将显示您选择的任何节点的当前设置、属性和值。
        6. `Master Stack (6)` 是着色器图的终点，它定义着色器的最终表面外观。它列出了顶点和片段着色器的主要着色器属性，并为您提供了将在其中插入必要值的最终节点。
    3. 练习在图表中移动：
        1. `平移(Pan)` ：单击鼠标中键并拖动，或者按住 `Alt (Windows)` 或 `Option (macOS)` 并单击并拖动。
        2. `缩放(Zoom)`：旋转滚轮或使用触控板缩放。
        3. `聚焦并放大(Focus and zoom in)`：选择一个元素并按 `F` 键。
        4. `适合窗口(Fit to window)`：按 `A` 键。

有关 Shader Graph 用户界面的完整文档，请 [参阅Unity 手册中的 Shader Graph 窗口文档](https://docs.unity3d.com/Packages/com.unity.shadergraph@10.7/manual/Shader-Graph-Window.html)。


### 3.添加程序图(procedural map)

本教程的目标是创建具有发光、透明、闪烁效果的自定义着色器。您可以按照以下步骤在库中重新创建着色器 - 或者随时进行实验！

基本的闪光是用 **procedural noise map** 制作的。**程序(Procedural)** 意味着纹理是通过某种公式或算法创建的，而不是来自图像或其他物理源。 Shader Graph 提供了一些程序噪声贴图可供选择。每一个都会生成一个类似云的地图，其中较亮和较暗的区域以看似随机的模式出现。

添加您的第一个节点：

1. 选择 Shader Graph 工作区，然后按空格键打开 `Create Node` 菜单。 （您也可以右键单击并选择 `Create Node` 。）
2. 使用顶部的搜索输入输入 `Gradient Noise` 。
3. `Gradient Noise` 节点将出现在结果中。双击将其选中。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/50562ebc-03d2-4770-9c5b-5599d7fc5ab7_CC_Shad_SG_3_1.jpg.2000x0x1.jpg)

### 4.随着时间的推移创造运动(motion)

渐变噪声贴图的程序纹理提供了我们想要的闪烁效果的变化。但我们如何让它动起来呢？您可能还记得，可平铺纹理的 `Offset` 属性会更改其在给定表面上的位置。在此着色器中，您将使偏移值连续变化，以便渐变噪声贴图移动。

正如 URP/Lit Shader 中 `Tiling` 和 `Offset` 一起出现一样，Shader Graph 中 Tiling 和 `Offset` 合并为一个节点。

1. 在工作区中，按空格键或使用上下文菜单（在大多数设备上在工作区中右键单击）创建新的 `Tiling and Offset` 节点。该节点将允许您调整噪声图的比例和位置。
2. 将 `Tiling and Offset` 节点的输出拖至 `Gradient Noise` 节点的UV输入。现在，您在平铺和偏移中输入的值将影响渐变噪声。
3. 更改 `Tiling and Offset` 节点上的 `Offset` 以查看偏移如何重新定位图案。我们的下一个目标是使图案不断移动以产生闪烁的效果。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/949f2f50-d7c7-4ec5-8687-57103de75c3a_CC_Shad_SG_3_2.jpg.2000x0x1.jpg)
4. 创建 `Time` 节点。该节点允许您随时间更改值。
5. 在本例中，您将更改 offset 以模拟着色器上的滚动效果。将 `Time` 节点的 `Time` 输出拖动到 `Tiling and Offset` 节点上的 `Offset` 输入。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/d85ca5c2-1b81-4f54-9ec6-e46df1c62894_CC_Shad_SG_3_3.jpg.2000x0x1.jpg)
    2. 噪声纹理现在已动画化！
6. 要查看默认材质的外观，请将 `Gradient Noise` 节点的输出连接到 `Master Stack` 中的 `Base Color` 。虽然还不是真正的闪光，但你已经在路上了！

> 重要提示：通过选择工具栏顶部的 `Save Asset` 来保存着色器。经常保存！

### 5.添加输入材质属性

如果该着色器允许使用它的艺术家（包括您自己）控制微光运动的速度，那么该着色器将对他们更有用。您可以使用设置材质属性的 `input nodes` 来完成此操作，从而允许艺术家使用材质更改着色器的外观。
输入节点在`Blackboard`中创建，其标题与着色器相同。

1. 选择黑板上的 ` plus (+)` 按钮，然后选择 `Float` 以创建新的 float（浮点值）输入节点。将其命名为 `ScrollSpeed` 。使用此输入节点，艺术家可以通过在材质中输入浮点数来调整速度。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/34616c56-e735-4970-a280-cc735aebf931_CC_Shad_SG_3_4.jpg.2000x0x1.jpg)
2. 将输入节点从 `Blackboard` 拖到工作区中。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/14c96339-223a-48de-903d-89526d12a53c_CC_Shad_SG_3_5.jpg.2000x0x1.jpg)
3.  Time 节点上没有输入槽，因此您需要采用不同的方式来组合 Time 和 ScrollSpeed 值。为此，创建一个 `Multiply` 节点。该节点是组合两个值的简单方法。它需要两个值，将它们相乘，然后输出结果。
    1.  提示：这是调出“创建节点”菜单的另一种方法：从 ScrollSpeed（或任何）节点的输出中拖动，然后在工作区的空白处放开。将出现“创建节点”菜单，当您选择一个节点时，它会自动连接到您开始时使用的输出。
4. 通过选择连接器并将其删除，断开 `Time` 和 `Tiling and Offset` 节点的连接。
5. 将 Time 和 ScrollSpeed 节点的输出连接到 Multiply 节点的输入。
6. 将 Multiply  输出连接到 Offset 输入。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/e3dfa712-1bb1-4d74-8273-4ffa75a2aa74_CC_Shad_SG_3_6.jpg.2000x0x1.jpg)
    2. 噪声图的滚动已停止！这是因为 ScrollSpeed 默认值为 0。对于使用此着色器的艺术家来说，此默认值应该大于 0，这样就不会发生这种情况。无论如何，将其更改为较慢的速度也可能会更好。
7. 要更改默认值，请选择 ScrollSpeed 节点，然后在图形检查器中输入新的默认值。尝试找到一个可以产生良好闪光的值。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/f5bfd138-2db8-4ea7-b774-2646dfaab7fb_CC_Shad_SG_3_7.jpg.2000x0x1.jpg)
   

### 6.组合贴图(Combine maps)

着色器现在具有移动噪声，但它可能更加闪亮。您可以通过将此贴图与以不同速度移动的不同噪声贴图相结合来创建更有趣的效果。为此，您将复制到目前为止所做的事情，稍微更改一下副本，然后将两张地图合并为一张。

就像向纹理添加运动一样，组合贴图是另一种只能在自定义着色器中创建的效果！

1. 选择您之前创建的“渐变杂色”、“乘法”、“平铺”和“偏移”节点（不要选择“时间”或“滚动速度”）。您可以绘制一个与它们接触的框，或者在选择它们时使用 `Ctrl (Windows)` 或` Cmd (mac)`。

2. 右键单击​​并选择 `Duplicate` 以复制所选节点。重复的 Multiply 节点仍将连接到相同的输入节点，这很有用。
   您可以通过降低输入 ScrollSpeed 来减慢新地图的运动速度，而不是加快该新地图的运动速度。例如，如果第二张地图的速度始终是第一张地图的一半，则这两张地图将创建一个不断变化的图案。

3. 要实现此目的，请在“时间”节点和重复的“乘法”节点之间插入一个新的“除法”节​​点。

4. 将 Time 节点的输出连接到 Divide 节点的输入 A，并将 Divide 节点的输出连接到 Multiply 节点的输入 B。

5. 使用 B 输入将 Divide 节点的值设置为 2，将 ScrollSpeed 除以 2。
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/257e00e4-e1b1-496c-b8b2-870505d34871_CC_Shad_SG_4_1.jpg.2000x0x1.jpg)
   
6. 现在您有两个不同的梯度噪声节点，以不同的速度移动。其中每一个都是值从 0 到 1 的灰度图。要组合它们，您可以使用 Multiply 节点来获取值在 0 到 1 之间的新图。在渐变噪声的右侧添加并连接一个新的 Multiply 节点节点，并将结果输出到Master Stack的Base Color。

### 7.对节点进行分组以保持组织有序

您的图表中现在有相当多的节点。到目前为止你所做的只是一部分。在继续之前，您可以将节点分组在一起以保持它们井井有条，以便更轻松地添加更多节点。

到目前为止，您组装的节点通过随时间改变偏移来在纹理中创建运动。您可以对它们进行分组并标记它们，以帮助您跟踪节点正在执行的操作：

1. 选择生成偏移设置的所有节点。这应该是梯度噪声节点左侧的所有内容（但不包括 the Gradient Noise nodes），如下图所示。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/82df1696-c7ca-43c4-b7b0-f7f4fe2fe296_CC_Shad_SG_5_1.jpg.2000x0x1.jpg)
   
2. 选择所有这些节点后，右键单击任意节点（不在工作区背景上）并选择 `Group Selection`  。您也可以按 `Ctrl/Cmd + G` 。将组命名为 `Changing Offset over Time` 。

3. 您还可以折叠各个节点的缩略图并移动它们，直到您满意为止。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/21e03133-3f67-498e-ae03-ce757f390759_CC_Shad_SG_5_2.jpg.2000x0x1.jpg)


### 8.允许材质中的纹理缩放

对于使用该着色器制作材质的艺术家来说，允许他们更改纹理的比例会很有用。例如，在大型对象上，微光着色器的输出（就像现在一样）可能看起来太小且有颗粒感。您可以添加一个输入节点，例如为 ScrollSpeed 添加的输入节点，以使纹理可缩放。

当您调整比例时，使两个组合纹理的比例不同可能会很有趣 - 事实上，它会增加闪烁效果。与将其中一张地图的 ScrollSpeed 除以 2 的方式相同，您也可以将其中一张地图的比例除以 2。

您已经执行了这些基本任务 - 尝试按照以下几条准则自行添加所需的节点：
- 将新的 Float 输入节点命名为 `GradientScales` 。
- 注意梯度噪声贴图的当前比例输入值。默认值为 10。您可以在输入节点中使用此默认值，或者尝试使用您更喜欢的值。将此与 `Example_Shimmer` 着色器进行比较。
  - 将 `GradientScales` 的输出接到一个 `Gradient Noise` 的 `Scale` 输入，和 Divide 后接到另一个 `Gradient Noise` 的 `Scale` 输入
- 在 `Example_Shimmer` 图中，运动较快的贴图由于其较小的“比例”值而具有较大的纹理（该比例的工作方式类似于“平铺”属性：它是每个单位的图块数量）。也请随意尝试一下！  
- 准备好后，将这些节点（包括渐变噪声节点）分组，并将组命名为“偏移和缩放”。

您的最终结果应类似于下图。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/4545ed86-ba0d-4a27-b619-ffa942b7d758_CC_Shad_SG_5_7.jpg.2000x0x1.jpg)


### 9.调整对比度
到目前为止，着色器变得更加闪亮，但它都是灰度的，有很多黑色，很多白色，中间没有太多灰色。接下来的两个节点将允许艺术家调整纹理的对比度和颜色。
要调整对比度，您将添加一个重映射节点，该节点会将值从 0-1 范围缩放到更窄的范围。通过缩小范围，最亮和最暗区域之间的差异将会更小。
1. 首先将 Vector2 输入节点添加到 Blackboard。 Vector2 只是一组两个值。将此输入节点命名为 `RemapValues` ，将其拖到工作区中，并将 Y 设置为 1。

2. 新建 `Remap` 节点  添加到工作区。

3. 将“偏移和缩放”组中 `grayscale map` 的输出连接到 `Remap` 节点的 `In` 输入（我理解时两个gradient noise 经过 multiply 后的输出）。这些是要 `Remap` 的输入值。

4. 将 RemapValues 输入节点连接到 Remap 节点的 `Out Min Max` 输入。这指定了艺术家可以调整的最小和最大输出值。

5. 确保 `In Min Max` 值分别设置为 0 和 1，以匹配输入值的实际范围。然后，RemapValues 节点会将 0-1 的值范围压缩到材质中指定的范围或 RemapValues 中的默认值
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/8b7f2bc2-b02d-42fb-a7cc-f433381e3db7_CC_Shad_SG_5_10.jpg.2000x0x1.jpg)

6. 使用图形检查器试验 RemapValues Vector2 的默认值范围。

7. 将重映射节点的输出连接到 `Master Stack` 中的 `Base Color`，以在 `Main Preview` 中查看结果。

将您的结果与 Example_Shimmer 着色器进行比较，并随意调整默认值，甚至节点连接，以获得您喜欢的闪烁结果。还有一个更重要的属性：颜色。


### 10.调整颜色和透明度

自行添加一个类型为 Color 的输入节点，名为 `TintColor` 。添加一个乘法节点以将此颜色乘以当前输出。将 `TintColor` 的默认值设置为您喜欢的颜色，并查看 Example_Shimmer 着色器以获取灵感。

将这些节点分组到标题为 `Intensity and Color` 的组中，结果将类似于下图。

![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/b01bd717-8a8b-4a0e-9e6f-7f1bbf8ea7b2_CC_Shad_SG_5_12.jpg.2000x0x1.jpg)

为了使这种颜色真正流行，请将其设为高动态范围 (HDR) 颜色：

1. 选择 TintColor 输入节点并在图形检查器中查看其默认属性。

2. 将 `Mode` 从 `Default` 更改为 `HDR` 。

3. 打开默认颜色的颜色选择器。现在，它具有与您在设置发射贴图时看到的 HDR 颜色选择器相同的“强度”选项。

4. 将新 Multiply 节点的输出连接到 Master Stack 中的 Base Color 输入，以便您可以看到到目前为止的结果。
   颜色还是不流行，是吗？您可以使用发射贴图使明亮区域更加明亮，这将使明亮区域发光，增加闪烁效果。

5. 从 Multiply 节点到主堆栈中的 `Emission` 输入建立另一个连接。现在这是一个自发光着色器！
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/e467bacf-b9a0-4f2b-bbe2-da862103b26b_CC_Shad_SG_5_13.jpg.2000x0x1.jpg)
    2. 还有一个技巧：您可以使颜色较浅的着色器透明，以创建更加闪烁的效果，该效果比整个对象具有相同透明度时更引人注目。

6. 在图形检查器的 `Graph Settings` 选项卡上，将此着色器的 `Surface` 类型更改为 `Transparent` 。这与您在 URP/Lit Shader 的材质中看到的设置相同。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/99389992-aa51-49fd-b451-2c1b1ca0d95f_CC_Shad_SG_5_14.jpg.2000x0x1.jpg)

7. 更改表面类型可启用主堆栈上的 `Alpha` 输入。将 Remap 节点的灰度噪声输出（不是 Multiply 节点的有色噪声！）连接到 Alpha 输入。
    1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/a37f5e5f-0ef9-47b0-8c58-8e66ce559745_CC_Shad_SG_5_15.jpg.2000x0x1.jpg)

现在你有了一个发光的、闪闪发光的着色器！只需进行一些调整，艺术家就可以使用此着色器更好地控制材质的外观。

### 11.完成着色器

看一下主堆栈的片段着色器输入。还有一些您还没有使用过。您可以将它们保留原样，并将使用该着色器制作的每种材质的默认值设置为默认值，或者您可以允许艺术家调整它们。

这是您的选择，但您可以尝试执行以下一些操作来使此着色器更有用：

1. 为 Metallic 添加一个输入节点（Float）并将其连接到主堆栈上的 `Metallic` 输入。

2. 为 Smoothness 添加一个输入节点（Float），并将其连接到 Master Stack 上的 `Smoothness` 输入。

> 重要提示：通过选择“保存资源”来保存着色器。


### 12.创建测试材料

就是这样，您已经创建了一个闪光着色器！剩下要做的唯一一件事就是从该着色器创建可应用于对象的材质。

现在创建一个测试材质并将其应用到着色器和材质库中工作台上的对象：

1. 在 `Assets > CreativeCore_Shaders > Materials` 文件夹中，右键单击并选择 `Create > Material` 。给这种新材料起一个名字，比如“Shimmer”。

2. 选择新材质后，转到检查器窗口更改着色器。它将列在 Shader Graphs 子菜单中。

### 13.探索 Shader Graph
Shader Graph 可以为您提供许多创建着色器和材质的机会。您可以从使用您的第一个着色器创建一套材质开始，进一步自定义着色器，甚至根据您所学的内容开始一个新的着色器！

根据您所学的知识，您可以轻松尝试以下一些操作：

- 创建一个着色器，允许材质艺术家输入 2D 纹理文件。提示：添加一个Texture2D输入节点和一个Sample Texture 2D节点来管理纹理文件的通道。

- 尝试艺术和程序节点。抖动、混合、Voronoi 和多边形可以很有趣！要查看有关任何特定节点的文档，请将其添加到您的工作区并使用上下文菜单（右键单击）选择 `Open Documentation` 。

- 检查 Shaders and Materials Gallery 项目提供的附加 Shader Graph 着色器：Dissolve_Shader。观察它如何使用 Sine、Add、Subtract 和 Branch 节点。阅读该着色器的 Shader Graph 工作区中的便笺。

- 检查 **Creative Core** 任务的指导项目之一（海滨小镇项目）中的着色器。查看该项目中的水着色器并了解如何创建水效果。

Shader Graph 上还有一些其他资源可以增强您的学习：

- [Unity 手册中的 Shader Graph 文档](https://docs.unity3d.com/Packages/com.unity.shadergraph@10.7/manual/index.html)

- [使用 Shadergraph 制作 Flag Wave](https://learn.unity.com/project/make-a-flag-move-with-shadergraph)：一个 Unity Learn 项目，将向您介绍顶点着色器和顶点位移的过程。

-[ Unity Asset Store 中提供 Shader Graph 着色器(免费资源)](https://assetstore.unity.com/?free=true&q=shader%20graph) ：检查其他创建者的着色器并向其学习。


# Mission 3 光照

在此任务中，您将在 Unity 编辑器中照亮室内和室外空间，并在此过程中了解 Unity 体验照明的基本原理。最后，您将应用所学知识来完成您自己的照明研究。

当您完成此学习体验时，您将能够：
- 以模拟真实世界光行为的方式在场景中实施适当的照明
- 决定适当的照明系统，以便在通用渲染管道 (URP) 项目中实现共同成果
- 配置光源和阴影以便功能性地照亮场景
- 配置环境（漫射环境）照明以传达情绪或增强真实感
- 生成 `Lightmapping` 以在场景中实现烘焙光照
- 配置光照探针以增加烘焙光照的真实感
- 配置反射探头以获得准确的反射
- 解决常见的照明错误，以便正确照亮场景

## Unity 中的光照入门

学完本教程后，您将能够：
- 解释直接光和间接光之间的区别。
- 定义术语全局照明。
- 确定 Unity 的 URP 全局照明系统。
- 解释 Unity 中实时光照和烘焙光照之间的主要区别。

### 2.检查外部照明示例

在接下来的几个教程中，您将使用两个示例场景：外部场景和内部场景。您将从处理外部场景开始 - 在此之前，让我们回顾一下！
按照以下说明检查外部场景：

1. 在 Unity 编辑器中打开 Creative Core: Lighting 项目（如果您尚未这样做）。

2. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Scenes ` 并打开 `FinalScene_Lighting_Outdoor`  。

3. 在顶部菜单中，转到 `Window > Rendering > Light Explorer` 。此窗口列出了场景中的所有光源以及您可以直接从窗口调整的关键细节。随着学习体验的进展，您将与此进行更多互动。 
   1. ![image](https://connect-cdn-public-prd.unitychina.cn/h1/20230807/learn/images/6d89d808-fbc3-42ee-9b80-915a3b572382_image.png.2000x0x1.png)

4. 在顶部菜单中，转到 `Window > Rendering > Lighting` 。您将在工作时使用此窗口来调整各种场景级设置，因此保持其打开会很有帮助。您也可以将“照明”窗口停靠在“检查器”旁边，通常效果很好。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20230807/learn/images/5a450465-2da4-426d-9232-db4e4de9f2c6_image.png.2000x0x1.png)
   2. Dock window: 拖住对应window 的 tab， 即可拖放

5. 如果您在上一个教程中没有这样做，请花一点时间在场景中导航。圆形剧场是进行照明练习的绝佳户外空间。您可以使用中央空间和不同的楼层进行一些非常有趣的光源和阴影实验！

### 4.Unity的全局照明系统

全局照明是一组可在 Unity 中使用的技术，可提供逼真的照明效果。这些技术称为全局照明，因为它们模拟直接光和间接光，而不仅仅是直接光。

Unity中有两种不同的全局照明系统： **Baked Global Illumination** 系统和 **Realtime Global Illumination system** 。

**Baked Global Illumination System**

 **Baked Global Illumination System** 包括：

- `Lightmapping` ：**预先计算场景中表面的亮度并将结果存储在称为 `Lightmapping`** 的纹理中的过程。该全局照明系统使用称为 **渐进式光照贴图器** 的特定 `Lightmapping` 器系统来完成此过程。
- `Light Probes` ：一种用于测量（或探测）有关穿过场景中空白空间的光数据的工具。
- `Reflection Probes` ：在 Unity 中模拟更真实反射的工具。

> 重要提示：在学习过程中，您将了解更多有关这些内容的信息 - 如果您现在不完全理解这意味着什么，请不要担心。

所有渲染管道都支持 **Baked Global Illumination** 系统，您将在处理本次学习体验中的所有场景时使用该系统。

**Realtime Global Illumination system**

 **Realtime Global Illumination system** 包括：

- `Lightmapping` ：此全局照明系统使用已弃用的 `Lightmapping` 器，称为 Enlighten Lightmapper
- `Light Probes` ： `Light Probes` 在此全局照明系统中具有一些附加功能。

Creative Core路径使用的通用渲染管道 (URP)不支持 **Realtime Global Illumination system** 。

> 注意：这超出了本次学习体验的范围，但Unity 2021 版本及更高版本的全局照明更新有更详细的信息。

**此学习体验中的实时和烘焙照明**

在本次学习体验中，您将使用 **Baked Global Illumination** 系统，而不是 **Realtime Global Illumination system** 。但是您将阅读并了解很多有关实时和烘焙照明的知识，如果您正在考虑全局照明，这可能（可以理解！）令人困惑。那么区别是什么呢？

实时光照和烘焙光照是两种不同的方法，用于确定 Unity 何时计算场景中的光照数据。实时照明和烘焙照明都可以在同一项目中实现，并且将它们结合起来通常是有效照亮场景的最佳方式。

在本教程的其余部分中，您将详细了解实时光照方法和烘焙光照方法之间的区别。

### 5.Unity中的实时光照

当游戏或其他实时体验运行时（即启动且用户参与体验时）， Unity 会在运行时计算实时光照。实时灯光每帧计算一次，这意味着它们可以对场景中移动的角色和其他元素非常敏感。

让我们探讨一下这在实践中意味着什么：

1. 在层次结构中，展开 **Lighting GameObject** 。

2. 选择三个 `StreetLamp` 游戏对象 之一。您选择哪一个并不重要。

3. 使用移动工具 `（Ctrl + W (Windows)` 或 `Cmd + W (macOS)）`  在空间中移动路灯，并观察场景中照明的变化。(此热键不起作用，直接用鼠标拖)


### 6.Unity中的烘焙光照

当场景变得更加复杂时，实时灯光可能会使用大量内存，这可能会导致性能下降，特别是对于硬件规格较低的玩家或用户而言。

烘焙照明通过在 **运行时（当用户参与游戏或体验时）之前** 预先计算照明数据来帮助缓解此问题。这可以减少硬件运行体验所需的资源密集程度。

执行计算并将数据保存为称为光照贴图的纹理的过程称为 **baking** 或 **lightmapping** 。

如果您已完成《创意核心：着色器》，您就了解了纹理及其在 Unity 渲染中的作用。正如您之前在本教程中了解到的，将在项目中使用的烘焙光照的计算将由称为 `Progressive Lightmapper` 的光照贴图器系统完成。

烘焙照明可以更高效，但它也可以用于实现对用户来说更真实、更有吸引力的照明。然而，这确实意味着当您与事物交互时，事物不会总是按照您期望的方式响应，除非以特定方式配置灯光和场景。

现在尝试使用场景中的其他路灯进行实验：

1. 在层次结构或场景视图中，选择 `Baked StreetLamp` 游戏对象。这是露天剧场中最高的一座。

2. 使用移动工具( Ctrl / Cmd + W )  在空间中移动此路灯并观察会发生什么。  

这盏路灯发出的光和你可​​以看到它在底座上投射的一小块阴影是通过烘烤过程固定的。他们无法响应您在场景视图中所做的实时更改。要更新它们，您需要重新烘焙场景的光照贴图。

您很快就会了解有关烘焙照明以及如何在场景中实现它的更多信息 - 现在，您将从实时照明的基础知识开始。

## 配置定向光和天空盒

当您在 Unity 编辑器中创建新场景时，您的场景视图会加载到明亮的蓝天。
定向光是为您创建的两个游戏对象之一。
这两件事是 Unity 中光照的绝对基础知识，默认情况下会提供帮助创作者入门。

学完本教程后，您将能够：
- 确定实际照明室外场景的关键考虑因素。
- 描述定向光在场景中的作用。
- 配置场景中的定向光以实现常见效果。
- 描述场景中天空盒的作用。
- 创建一个程序天空盒。

### 3. 识别光源类型

确定场景所需的光源是照明设计和实施的关键初始步骤。这包括：

- **自然光**，通常是太阳或月亮。
- **动机照明(Motivated lighting)**，模仿场景中特定的真实光源，例如路灯或汽车前灯。
- **关键照明(Key lighting)**，是一种没有可识别光源的光，用于照亮场景中的焦点对象。
- **环境光（在 Unity 中也称为漫射环境光）**，是对场景产生影响的另一种光，并非来自特定源对象。


**您的户外场景目标**

花点时间考虑一下将室外场景转换为深夜照明并记下您的想法：

- 重要的光源是什么？
- 您想添加哪些额外光源？
- 根据您如何配置这些灯光，您可以创造出哪些不同的氛围？

在接下来的几个教程中，当您有机会自定义场景时，请使用这些初步想法作为指导！


### 4.配置定向光

在 Unity 中，每当您创建场景时，它都会附带已添加到层次结构中的定向光；这盏灯的作用就像你的太阳或月亮。

定向光沿小控件（与特定游戏对象关联并显示在场景视图中的图形叠加）指示的方向投射直线平行光线：

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221108/learn/images/d7721c97-1d6a-46cf-8515-00c4274f098a_3_4a.png.2000x0x1.png)

> **光波自然想要扩散，但在定向光的情况下，你不会得到这种效果**，因为它距离场景很远（因为太阳距离地球很远）。相反，它会将平行的直线光线投射到场景中。


测试一下：

1. 在 Unity 编辑器中打开 Creative Core: Lighting 项目（如果您尚未这样做）。

2. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Scenes` 并打开`TutorialScene_Lighting_Outdoor`  。您查看的上一个场景是一个精美的示例 - 这是您将在前几个教程中使用的场景。现在你应该只看到一个空荡荡的圆形剧场，背景是天空。
   1. 如果您在场景视图中只看到灰色，请使用场景视图控制栏中的 `Effects` 下拉列表来启用天空盒。
   2. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221108/learn/images/38c09182-25c7-4cd5-9d02-fd2fc6661c8d_3_4b.png.2000x0x1.png)

3. 在层次结构中，展开 `Lighting GameObject` 。

4. 选择 `Directional Light GameObject` 。您应该注意到它位于圆形剧场中央空间的上方。如果您的图标设置得足够大，您应该会看到太阳图标以及光线方向小控件。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221108/learn/images/3ac5a98b-ab8e-4ed0-b762-3d6442ae51b9_3_4c.png.2000x0x1.png)
   2. **提示：**如果您没有看到该图标，但想要看到该图标，请选择“场景”视图控制栏中的 `Gizmos` 下拉列表，然后使用滑块增加 `3D Icon` 大小。

5. 尝试将定向光移动到场景中的不同位置：更近或更远。**您应该注意到，这些变化引起的光照没有差异** - 与真实太阳不同，定向光的位置不会改变光的方向。

6. 使用旋转工具 ( E )更改定向光的方向。您应该注意到场景中已有的天空会对其位置变化做出响应。 

7. 仍然选择 `Directional Light GameObject` 的  情况下，转到 Inspector 并找到 `Light -> Emission -> Color` 属性。

8. 选择颜色框以打开颜色选择器窗口并选择新的色调。注意圆形剧场的结构——这是最容易看到颜色变化影响的地方。这可以帮助您营造场景气氛。

这种效果可能相对微妙，并且不一定适合场景当前配置的方式。

如果场景设置在深夜而不是清晨，神秘的紫色或不祥的红色可能会产生更大的影响。现在可以随意尝试不同的颜色，但在本教程结束时您将有机会更多地调整定向光。


### 5.定向光的高级使用

**创建多个功能性的太阳或月亮**

您可以向场景中添加多个定向光，但只有其中一个可以正常充当太阳或月亮，除非您专门配置项目来解决这一问题。

**一天中的时间转换**

您可能玩过游戏，一天中的时间会随着您的游戏而变化，而不是保持不变。这可以在 Unity 中完成，但这超出了本学习体验的范围。


### 6.开始使用天空盒

Unity 中的天空背景是使用一种称为  **skybox**  的特殊类型材料创建的。

**Skybox** 是每个面具有不同纹理的立方体。当您使用 **skybox** 渲染天空时，Unity本质上会将您的场景放置在 **skybox** 立方体内。

> Unity首先渲染立方体，因此天空会渲染在场景中其他任何东西之后。

尽管场景的默认天空盒只是晴天的基本白天天空，但此背景可能包括远处的环境特征。这些有助于增强空间感和深度感，包括：

- 景观特征 —— 考虑一个以遥远的高山为背景的电影布景
- 建筑物 —— 例如，一座巨大的幻想城市就在地平线上可见

例如，外星人视频游戏店引导项目有一个有趣的天空盒来适应其氛围和外太空主题。

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/5e9e9f61-6ff6-421d-b866-364abb6afa1a_CC_Light_3.6.0_SpaceCartoonSkybox.png.2000x0x1.png)

应用于天空盒立方体的材质需要使用天空盒着色器。 Skybox 着色器有两类：
- **纹理(Textured)**：一组使用材质纹理生成天空盒的着色器。
- **程序(Procedural)**：使用材质属性来生成天空盒的着色器。

### 7.创建一个新的程序天空盒
接下来，将默认天空盒切换为自定义程序天空盒：
1. 在“项目”窗口中，导航至 `Assets > CreativeCore_Lighting > Materials` 。

2. 在窗口中右键单击并选择 `Create > Material` 。为您的新材料起一个清晰的名称，以帮助您以后找到它。

3. 在 新建Material 的Inspector 中，转到Shader属性并使用下拉列表  选择 `Skybox > Procedural` 。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/bf93a048-91ce-4227-b501-57beabfd1a1c_CC_Light_3.7.3_ShaderDropdownCallout.png.2000x0x1.png)
   2. 与您在完成Creative Core：着色器和材质时看到的其他着色器一样，此着色器具有一组可以使用材质进行配置的特定属性。  

4. 在配置天空盒之前，在场景中渲染它会很有帮助，这样您就可以看到更改的影响。转到 `Lighting` 窗口停靠的位置，然后选择 `Environment` 选项卡。

5. 将新材质拖至 `Skybox Material` 属性并释放以对其进行分配。 

6. 现在返回检查器中的自定义材质设置。花点时间查看您可以配置的属性：
   1. **Sun**：这是Unity用来在天空盒中创建太阳盘的方法。将其设置为“简单” 。
   2. **Sun Size**：这是太阳盘的大小修正值 - 值越高，它在天空中出现的越大。
   3. **大气厚度 Atmosphere Thickness**：大气的密度——大气越稠密，吸收的光就越多。
   4. **天空色调 Sky Tint**：天空的色调。
   5. **地面 Ground**：地平线以下区域（地面）的颜色。
   6. **曝光 Exposure**：这可以调整天空的曝光。较大的值会产生更暴露的天空盒，看起来更亮。

### 8.打造深夜妆容

现在，您已准备好应用您所学到的知识，开始配置此场景以实现深夜外观。

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/74319cf3-3ad7-4e73-8f6e-e2854ebbcbed_CC_Light_3.8.0_1_NightSkyExampleUpdate.png.2000x0x1.png)

这里的天空呈紫色，但仍然相当明亮，尤其是靠近地平线的地方。定向光的粉紫色现在很容易看到，但天空和定向光目前提供了非常风格化的外观。

假设我们想要开发这个示例来创建更真实的夜间外观。我们可以尝试调整颜色并稍微降低程序天空盒材质中的 **大气厚度值(Atmospheric Thickness)** ：

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/203499f7-9794-422c-ac22-cb1537da6e83_CC_Light_3.8.0_2_NightSkyExample2Update.png.2000x0x1.png)

这样好多了！当您自己工作时，请记住定期保存更​​改。

**Tips:**
- 天空盒的变化可能更加引人注目，但也不要忘记调整定向光配置。对 `Color` 属性的微小更改可以对场景的气氛产生微妙但有效的影响。
- 就像这个例子一样，迭代照明几次（或多次）直到获得满意的结果是绝对正常的。

### 将光源添加到场景中

学完本教程后，您将能够：
- 识别不同类型的光组件之间的差异。
- 配置Light组件以实现常见的灯光效果。
- 配置场景中的环境（漫射环境）光。


### 光源类型

您可以使用两种不同类型的光源：
- `点光源(Point Lights)`：这些光源从空间中的一个点向各个方向均匀地发出光线。您可以使用它们来模拟灯等光源。它们在场景视图中用灯泡图标表示。

- `聚光灯(Spot Lights)`：这些灯从空间中的一点发出锥形光线。您可以使用它们来模拟手电筒等光源。它们在场景视图中用一个看起来有点像聚光灯的图标表示。

首先添加一个新光源：
1. 在 Unity 编辑器中打开Creative Core: Lighting项目（如果您尚未这样做）。

2. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Scenes` 并打开 `TutorialScene_Lighting_Outdoor`  。

3. 转到 ` Assets > CreativeCore_Lighting > Prefabs` 并将 `StreetLamp Prefab` 拖入场景视图中以将其实例化。将其放置在圆形剧场中您喜欢的任何位置。
    1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/0ad78039-23aa-41e2-be25-d05d81b9b5c0_CC_Light_4.2.3_StreetLampPlacedUpdate.png.2000x0x1.png)

4. 在层次结构中，展开父 StreetLamp GameObject 并选择 Spot Light GameObject。这是该对象实例化时出现的光源。
    1. 注意：如果您在不使用道具预制件的情况下添加灯光，则可以通过层次结构中的添加( + ) 菜单创建一个已添加灯光组件的游戏对象。您还可以将 Light 组件添加到任何 GameObject。

5. 在 Inspector 中，找到 Light 组件并将其禁用。这将关闭场景视图中的灯 - 在继续之前再次启用该组件。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/77aa3d6f-d841-4888-86eb-a20bcfdaf566_CC_Light_4.2.5_LightComponentUpdate.png.2000x0x1.png)

6. 在 Light 组件中，找到 `Type` 属性并使用下拉列表将其更改为 `Point`  。请注意这对路灯投射的光的形状造成的差异：它发出的光现在均匀地向各个方向发出，而不是受到聚光灯的锥形形状的限制。

7. 现在将类型切换回 `Spot` 。


### Light 组件配置

1. 向右或向左拖动 `Range` 属性，以增加或减少灯光在场景中传播的距离。您也可以手动输入一个值；数字越大，范围越大。
   1. 由于其形状的限制，聚光灯的范围受到限制。将值增加到超出该上限将不会导致范围进一步增加。

2. 向右或向左拖动 `Intensity` 属性，可在设定范围内增加或减少灯光的强度。与 `Range` 一样，您也可以手动输入一个值。
   1.  尝试设置非常高的强度值 — 超过1500 。您可以将光源的强度设置为超出 Unity 中光源和范围的自然强度，但对于有动机的照明，您应该谨慎使用它。在这种情况下，将Intensity属性设置得太高会使路灯看起来更像泛光灯而不是实际的路灯！
   2. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/ef7253d3-6cd3-4982-aefb-23b894e09e7d_CC_Light_4.3.3_StreetLampHighIntensityUpdate.png.2000x0x1.png)
   3. 现在将 `Intensity` 属性  设置为 **200到600** 之间的更实际的值。

3. `Indirect Multiplier` : 属性会影响该光源提供的间接光的强度（在被传感器接收之前反射多次的光）。如果你设置它：
   1. 低于1 时，每次从物体反射回来的间接光都会变暗。这是真实光线的行为方式，但您可能希望覆盖该行为以实现特定的照明效果。
   2. 高于1 时，间接光将随着每次反射而变得更亮。这并不自然，但如果您试图照亮场景中黑暗、封闭的空间，它会非常有用。
   3. 现在，将此设置保留为1 。 

4. 选择 `Color` 属性框以打开“颜色选择器”窗口并调整灯光的颜色。花点时间尝试一些符合您户外场景目标的东西。

### 色彩空间

项目中的照明可能是一项微妙的工作，涉及许多相互关联的因素——故障排除对于照明艺术家来说是一项非常常见的活动。如果在其他故障排除后您的灯光不成比例地熄灭（明亮）或不匹配，请务必检查您的项目是否设置为 `线性色彩空间(Linear color space)` 。

为您的项目选择的色彩空间将影响照明的渲染方式。色彩空间通常也可能是您尝试对渲染进行奇怪故障排除的灯光的原因。

有两种不同类型的色彩空间：
- Gamma ，3D 模板中的默认值
- Linear ，URP 模板中的默认值

线性色彩空间工作流程可实现更精确的渲染，因此通常是您更适合使用的一种。该项目是使用 URP 模板创建的，因此默认设置为线性颜色空间。


如果您想预览场景在 Gamma 空间中的渲染方式：

1. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Scenes` 并打开 `FinalScene_Lighting_Outdoor` ——目前有更多内容可供查看。

2. 在主菜单中，转到 `Edit > Project Settings…` 。

3. 在侧面导航栏中，选择 `Player` 并展开 `Other settings` 折叠页。

4. 在 `Rendering` 部分（位于顶部）中，使用下拉菜单将 `Color Space` 属性更改为 `Gamma` 。

5. 当您检查完此色彩空间中的场景后，请确保在关闭“项目设置”窗口之前将 `Color Space` 属性重置为 `Linear` 。

6. 再次  打开 `TutorialScene_Lighting_Outdoor` 场景以继续在那里工作。


### 7.配置环境灯光

**环境光(Ambient light)** 是场景中存在但没有特定来源的光。

这对于提高可见性或通过照明创建特定的风格效果非常有用，因为它将统一的颜色应用于场景中的所有对象。 Unity 的环境实时光照被计算并存储在光照贴图中。

它很少是您可以配置一次然后忘记的东西 - 与所有照明设计和实现一样，它通常是迭代的。让我们首先回顾一些基本设置：

1. 转到已停靠 `Lighting` 窗口的位置（或通过顶部菜单再次打开它：`Window > Rendering > Lighting` ）。

2. 在 `Lighting` 窗口中，选择“环境”选项卡。
    1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/a93016cd-d933-442c-be71-2bec802d5967_CC_Light_4.7.2_EnvironmentTabCallout.png.2000x0x1.png)

3. 在 **Environment Lighting** 部分中，找到 `Source` 属性。目前，它设置为您之前在本学习体验中创建的天空盒，这意味着天空盒正在场景中提供环境照明。这很简单，但往往很有效。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/6a96aea9-77e8-49ca-a05a-29502dff29b0_CC_Light_4.7.3_ELSourceCallout.png.2000x0x1.png)

4. `Intensity Multiplier` 属性控制场景中环境光的亮度，可以是 **0到1** 之间的值（默认值为1 ）。尝试一下这对场景中的照明产生的差异。
     1. 注意：游戏对象需要标记为静态才能包含在环境光照的光照贴图中。这是因为光照贴图数据是预先计算的，并且只能针对运行时不移动的游戏对象进行计算。当您为此场景烘焙光照时，您将了解更多相关信息。

5. 将 `Source` 属性  设置为渐变。现在，您可以使用颜色选择器为场景中的天空、赤道和地面环境照明设置特定颜色。尝试改变这些，看看有什么影响。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20230823/learn/images/b20e4cf2-4d9c-47ef-9944-cc19e3b7d55f_lighting-examples-three.png.2000x0x1.png)
   2. 注意场景中的每个 3D 对象如何受到环境光的影响，从而使您能够非常快速地实现统一的风格。

6. 完成实验后，暂时将 `Source` 设置回天空盒。如果您愿意，您可以在对户外场景进行最终自定义时使用不同的 `Source` ！

7. 保存您的更改。

## 配置场景中的阴影

学完本教程后，您将能够：
- 解释照明和后处理之间的关系。
- 在场景中配置阴影以实现逼真的效果。

### 2.配置渲染管线资源

当光线无法穿过某个对象时，该对象会产生阴影 - 现在您的场景中有多个光源，您可以配置它们。

在 Unity 中，阴影存储在称为阴影贴图(shadow map)的纹理上，它将场景中的所有内容展平为一个纹理（图像），然后在顶部打印阴影。纹理的分辨率越高，场景中阴影的质量就越高。

首先，首先检查通用渲染管道资源设置的 `Shadows` 部分：

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/63981b7c-ec5c-4823-b4ae-dec0742bf167_CC_Light_5.2.2_RPShadowsCallout.png.2000x0x1.png)

1. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Settings > Rendering`  ，然后选择 `UniversalRP_HighQuality` 资源。这是项目中当前使用的渲染管道资源。

2. 在检查器中，找到 `Shadows` 部分。

3. `Max Distance` 属性是Unity渲染阴影时距相机的最大距离。将 `Max Distance` 设置为0 ，然后观察逐渐增加该值时场景中发生的情况。
   1. 完成后将最大距离设置回100 。有时您可能希望对其进行配置以实现特定效果，但目前效果很好。

4. `Depth Bias` 和 `Normal Bias` 属性有助于解决对象上的像素处于阴影中但实际上应该被照亮的问题（这称为阴影痤疮）。目前这在您的场景中应该不是一个重大问题，但请尝试调整这两个设置以评估影响。

5. 启用 `Soft Shadows`。此属性可以进行额外的处理，使阴影看起来更平滑。

6. 找到 `Cascades Count` 属性。这控制了项目中使用的阴影级联数量。这些有助于解决由定向光（透视混叠）创建的靠近相机的阴影像素化问题。在场景中使用的级联越多，阴影受透视锯齿的影响就越小。
   1. `Cascade Count` 设置为1 ，然后将焦点放在您创建的路灯簇上，同时拖动属性名称以将阴影级联数逐渐增加到4 。您应该注意到，每个附加级联都会提高场景中阴影的质量。

### 3.在定向光中启用软阴影

现在您已经考虑了管道资源，您可以在定向光中启用软阴影：

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221109/learn/images/78df5e5a-07a3-449d-bd0a-5538b9198e53_5_3.png.2000x0x1.png)

1. 在层次结构中，选择 `Directional Light` 。

2. 在检查器中，转到 Light 组件并将 `Shadow Type` 更改为 `Soft Shadows` 。

> 注意：此更改在该场景中造成的差异太细微，难以注意到；这很常见。然而，在某些情况下，这可能会改变场景中阴影的整体感觉和风格 - 值得将其包含在您的过程中。

软阴影和阴影级联都使用内存和带宽进行渲染，但它们比使用高分辨率阴影贴图的处理强度要低，高分辨率阴影贴图是提高场景中阴影质量的另一种方法。

### 4.考虑post-processing对光照的影响
您是否曾经拍摄过室外美丽环境的照片，却发现颜色比您看到的颜色要少得多？并非所有相机传感器都是一样的，并且有很多变量可以准确影响传感器接收的内容。

如果您想让照片更符合您的体验，您可以为其添加滤镜或效果以增加颜色的活力。在简单的图像编辑器中，这可能只需要选择一个预设，但专业人员可以配置许多属性和效果来优化图像以获得正确的效果。

Unity 中也类似：迭代应用和完善后处理效果可以对项目中照明的整体美感产生重大影响。

当您专注于照明时，我们已经为两个示例场景添加了后处理效果 - 您将在[Creative Core：后处理](https://learn.unity.com/mission/creative-core-post-processing)中了解有关这些内容的更多信息。


要查看没有适当的后处理效果的情况下该场景的外观：
1. 在层次结构中，选择 `PostProcessing` GameObject。

2. 在检查器中，找到“后处理体积” 。您应该看到场景中当前使用了四种效果： 
- 盛开 Bloom
- 色调映射 Tonemapping
- 小插图 Vignette
- 色差 Chromatic Aberration

3. 禁用 `PostProcessing` GameObject 以关闭这些效果并在场景视图中查看其影响。完成后，记得再次启用它！

## 为您的场景烘焙光照贴图

现在您已经在室外场景中设置了实时照明，您可以为项目设置第二种类型的照明：烘焙照明。

当您实现了这一点并对整个场景的照明配置进行了一些调整后，您就已经掌握了外部空间照明的基础知识！

学完本教程后，您将能够：
- 适当配置光源，以便可以进行烘焙。
- 创建一个新的照明设置资源。
- 解释为什么烘焙光照的任何更改都需要更新光照贴图。
- 为您的场景自定义光照贴图属性。

### 2.什么是烘焙照明？

Unity 中有两种不同的光照方法：实时光照和烘焙光照。让我们花点时间回顾一下这两种方法。

**实时照明**
Unity 在运行时计算实时光照（当您的游戏或其他实时体验运行时）。您在之前的教程中创建的定向光和其他光源目前都是实时光源。

这些灯光每帧计算一次，这意味着它们可以对场景中移动的角色和其他元素非常敏感。然而，当场景变得更加复杂时，这些灯光可能需要大量内存，这可能会导致性能下降——特别是对于硬件规格较低的玩家或用户而言。

**烘焙照明**

Unity 会在运行前（在用户与您的体验交互之前）预先计算烘焙光照。这意味着 Unity 在运行时需要做的就是将光照数据应用到场景。您无法更改在运行时烘焙的灯光的属性，并且它们不会响应动态游戏对象（例如角色走过场景）。

**计算光照的过程涉及生成整个场景的 UV 坐标，就像用于在材质中映射纹理的 UV 坐标一样。这种纹理贴图称为光照贴图**，创建它的过程称为光照贴图或烘焙。

烘焙照明可以更高效，但它也可以用于实现对用户来说更真实、更有吸引力的照明。

### 3.改变灯光模式

光照模式设置使您能够选择要在 Unity 项目中采用的光照方法：
- 烘烤
- 即时的
- 混合

目前，工作场景中的所有灯光都是实时的。在创建烘焙之前，您需要更改其灯光模式：

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221109/learn/images/00cf0de5-f4ef-40d8-8bb6-a79f455931f7_6_3.png.2000x0x1.png)

1. 在 Unity 编辑器中  打开Creative Core: Lighting项目（如果您尚未这样做）。

2. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Scenes` 并打开 `TutorialScene_Lighting_Outdoor` 。

3. 在层次结构中，展开 `Lighting` GameObject 并选择 `Directional Light`  。

4. 在 Inspector 中，找到 `Light` 组件中的 `Mode` 属性。

5. 将 `Mode` 设置为 `Baked` 。

6. 选择已添加到场景中的其他光源的 GameObject，并以相同的方式将其 `Mode` 属性设置为 `Baked` 。

> **Quite Useful!!!** 提示：您可以使用 Light Explorer 窗口（顶部菜单：`Windows > Rendering > Light Explorer` ）来快速更改这些。

### 4.将光源设置为静态

如果游戏对象在运行时不移动，则它被视为静态。

您可以使用 `Static` 属性将这些游戏对象标记为静态。然后，Unity 将能够在运行之前预先计算有关它的数据，包括存储在光照贴图中用于全局照明的数据。

在烘焙光照贴图之前，您需要将场景中的光源标记为静态：

1. 在层次结构中，选择环境游戏对象。在检查器中，启用其静态属性。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/35ce19bf-c625-4c5e-859c-89d065cbb33c_CC_Light_6.4.1_StaticPropertyCallout.png.2000x0x1.png)

2. 在出现的“更改静态标志”对话框窗口中，选择“是，更改子项” 。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221109/learn/images/abeac8a6-269a-4969-beb5-7f38810c29ad_6_4.png.2000x0x1.png)
   2. 这会将飞机和圆形剧场环境设置为静态。

3. 选择已添加到场景中的任何其他照明道具游戏对象并启用 `Static` 属性。

4. 在圆形剧场空间的中心添加两个额外的 StreetLamp Prefabs进行测试。仅将其中之一设置为 `Static` ，以便在烘焙光照贴图后可以观察它们之间的差异。选择已添加到场景中的光源的 GameObjects 并将其 `Mode` 属性设置为 `Baked` 。

### 5.烘焙光照贴图
到目前为止，您在本教程中不会看到任何明显的更改影响，因为您**尚未生成光照贴图来存储光照数据**。现在您已准备好这样做了。

> 重要提示：在这个学习项目中，所有网格体都有光照贴图 UV。如果要导入没有光照贴图 UV 的新网格，则需要在烘焙光照贴图之前创建一个或让 Unity 自动生成一个。

**在开始烘烤之前**

Lightmapping Settings: 
- Progressive CPU Lightmapper(default)
- Progressive GPU Lightmapper (preview)

**烘焙你的光照贴图**

1. 在“照明”窗口（顶部菜单：`Window > Rendering > Lighting` ）中，转到 `Scene` 选项卡。选择 `New Lighting Settings` 。  
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20230807/learn/images/7bddad3b-75c2-4af6-9219-9ead147fc960_image.png.2000x0x1.png)

2. Set the `Lighting Mode` property to `Baked Indirect` 。如果您满足硬件和软件要求，现在还可以将 Lightmapper 属性设置为 `Progressive GPU（preview）` 。

3. 在“项目”窗口中，将新资源命名为 `Baked Lighting` 并将其移至 `Assets >  CreativeCore_Lighting > Settings > Lighting` 。

4. 返回 `Lighting` 窗口，选择窗口底部的 `Generate Lighting` 来烘焙光照贴图。您将在 Unity 编辑器窗口页脚的右侧看到烘焙进度。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/df982cce-dc4e-4427-9589-1b2975234b9e_CC_Light_6.5.4_GenerateLightingCallout.png.2000x0x1.png)
   2. 注意：这可能需要一些时间来处理，并且您的计算机会变慢，尤其是第一次烘焙光照贴图时。这是预期的行为。

5. 注意圆形剧场中央的两盏路灯。您应该注意到，未设置为静态的灯不会像您预期的那样投射光。

6. 尝试移动您烘焙的圆形剧场中心的路灯。正如您在[Unity 照明系统入门](https://learn.unity.com/tutorial/get-started-with-lighting-in-unity)中观察到的那样，您应该注意到，当您移动静态 StreetLamp 游戏对象时，灯光和阴影会固定到位。

### 6.添加区域光(Area Light)

区域光是从矩形一侧均匀发射光到该侧表面区域的矩形。您可以使用这些灯光获得微妙的效果，因为它们可以同时从多个方向照亮物体。

> Area Light 是 baked only 的

使用区域灯为圆形剧场添加一些室外特色照明：
1. 在“项目”窗口中，转到 `Assets > CreativeCore_Lighting > Prefabs.` 。选择 `LongLight` Prefab 并在场景中实例化它。  

2. 将 `LongLight` 放置在圆形剧场上 - 直接放置在其中一个高层的环境上是一个很好的起点，就像它们在示例场景中的排列一样。

3. 在检查器中，将区域光的 `Color` 属性更改为您在场景中易于识别的颜色。饱和的明亮颜色可能对此有所帮助。

4. Set the `Range`, `Intensity`, and `Indirect Multiplier` properties。现在，尝试将区域光设置为大范围的亮光，以便您可以评估它对场景的影响。您可以使用场景视图中的指导小控件来帮助您观察调整这些属性时的影响。
   1. 注意：如果您需要回顾这些属性，请查看[之前的教程](https://learn.unity.com/tutorial/add-light-sources-to-your-scene#619ce590edbc2a3ca45150b9)。

5. 在 `Lighting` 窗口中，选择 `Generate Lighting` 以更新烘焙并查看光照。

6. 如果您想进行任何进一步的调整或添加更多区域光，请确保更新您的烘焙，以便您可以看到它们对场景的影响。

### 7.将灯光模式设置为 Mixed

此刻，场景中的路灯已经烤熟。您可以将 set the `Light Mode` to `Mixed` 以创建混合灯光。**它们将动态（实时）阴影与来自同一光源的烘焙光照相结合**。

当用户探索您的体验时，这需要更多处理，**但它可以提高阴影的质量**。对于像这样相对较小且轻量级的项目，通常值得付出性能成本。

一般来说，如果您正在为桌面平台创建游戏或应用程序，您将使用混合、实时和烘焙照明的组合。然而，仅使用烘焙照明可以更轻松地展示可感知的结果，这对学习体验很有帮助。

如果您正在从事像这样的相对较小且轻量级的项目，那么使用混合照明通常值得付出性能成本。

要将路灯切换为混合灯，您需要调整灯光模式：

1. 在层次结构中，展开 `StreetLamp` 游戏对象并选择其子聚光灯游戏对象。

2. 在 Inspector 中，找到 `Light` 组件中的 `Mode` 属性。

3. 将 `Mode` 设置为 `Mixed` 。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221109/learn/images/6eededf6-86a0-4a6c-b2b3-0130e1c87e29_6_7.png.2000x0x1.png)

4. 对添加到场景中的其他灯光重复此过程。

5. 在“光照”窗口中，选择“生成光照”以更新烘焙。

6. 检查场景中的阴影 - 您的更改是否会产生明显的影响？在这种特殊情况下可能不会，但混合光是一个可供您使用的有用工具。

7. 将更改后的灯光设置回烘焙模式并重新烘焙灯光。

8. 保存您的更改。

## 使用光探针改善您的照明

学完本教程后，您将能够：
- 解释光照探针如何提高场景中光照的真实感。
- 将光探针适当地放置在场景中。
- 使用诊断视图评估光探针的影响。

### 2.动态对象

静态 Baked 光 不会影响您的动态（移动）球体。

Light Probes 可以解决这个问题。您已经在光照贴图中存储了有关光线如何照射场景中不同表面的数据。您可以使用光探针来测量（或探测）有关穿过场景中空白空间的光的数据。

在运行时，**来自最近的光探针的数据**用于估计应该照射到场景中任何移动游戏对象的光。

光照探针使烘焙光照更加真实。

如果您小心放置它们，与实时灯光相比，它们在运行时的使用效率也相对较高。

光照探针通常可用于解决在照亮动态对象时可能遇到的烘焙光照问题，但它们对于**场景中光照发生显着变化的区域**也非常有用。如果用户在这些区域没有看到动态对象以他们期望的方式对照明作出响应，则可能会对他们的沉浸式体验产生负面影响。

### 4.我怎么知道把它们放在哪里？

排列光探针组的最简单方法是将各个探针放置在**规则网格**中，您希望它们测量（探测）光。

这个网格应该**至少有两个垂直层**——因此，它被称为3D 体积。

![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/1984ea32-38cd-40cc-ac35-9e000f8aa33b_CC_Light_Graphic_8.png.2000x0x1.png)


### 5.将光探针放置在场景中


1. 首先，将用于测试的 StreetLamp 游戏对象移出圆形剧场的中心，以便您有一个清晰的工作空间。

2. 在层次结构中，选择 `Add (+) > Light > Light Probe Group. `

3. 选择新创建的光探针组。缩放它以使探针更大（如果看不到probe，Scene window 右上角启用 `gizmo` 并调节 `3D icon` 的大小），然后将其移动到地面上方开放的圆形剧场空间的中心。当路灯放置在地面上时，检查光探头顶层是否有足够的高度覆盖路灯。
    1. 重要提示：在继续执行下一个说明之前，请仔细检查光探头的底层是否高于圆形剧场的地面。如果光探针的底层位于地面以下，它们将无法捕获地面以上的照明数据，因此会给出不正确的结果。

4. 在检查器中，选择 Light Probe Group 组件中的 `Edit Light Probes` 。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/2f6610fa-c4ff-4d69-901b-3923243a8e59_CC_Light_7.5.4_EditLightProbes.png.2000x0x1.png)

5. 在检查器中，选择 `Select All` ，然后选择 `Duplicate Selected` 。

6. 将组中复制的光探针向右移动以扩展网格图案。

7. 扩展网格以填充放置路灯的圆形剧场的中央空间。这样做时，尝试选择较小的组或单个光探针以及整个光探针组，以练习以不同的方式放置它们。

8. 完成后，将路灯放回原来的位置。确保光探针组覆盖路灯投射的光 - 如果没有，您可以升高光探针的顶行或为 3D 体积创建一个新层。


### 7.尝试使用一些工具来检查场景
Unity 编辑器具有一系列诊断视图和工具，您可以使用它们来检查和评估场景的照明状态。

在 Light Explorer 窗口和诊断视图中检查您的 Light Probe ：

1. 转到 Light Explorer 窗口停靠的位置或再次打开它（顶部菜单：`Window > Rendering > Light Explorer` ）。
   1. 在此窗口中，有许多选项卡可用于查看、选择和编辑场景中光源的属性。默认的 `Light tab` 显示场景中的光源，您可以直接在窗口中编辑它们。

2. 选择 `Light Probes tab` 。您可以使用它来检查场景中光探针的状态。  
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/7ec878a8-812d-416f-bda2-9ed430d25fb7_CC_Light_7.7.2_LightExplorerLP.png.2000x0x1.png)

3. 在场景视图控制栏中，使用 `Draw Mode` 下拉列表（顶部中间）选择  `Contributors /  Receivers` （在 `Global Illumination` 部分中）。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20221109/learn/images/bb503ab7-2234-4d33-bbf1-2d22222df071_7_7.png.2000x0x1.png)

4. 您会注意到场景视图中出现了彩色叠加层。
   1. ![img](https://connect-cdn-public-prd.unitychina.cn/h1/20211123/learn/images/53e6787e-1afe-4ab0-8ea5-6823f386dbfe_CC_Light_7.7.4._DrawModeSceneView.PNG.2000x0x1.jpg)
   2. 在此绘制模式下，场景中游戏对象的网格渲染器会以不同的颜色绘制，具体取决于它们是否对全局照明有贡献以及它们是否/如何接收全局照明。
   3. 以下是此诊断视图中每种颜色所表示含义的高级概述：
      1. **黄色**：游戏对象未设置为静态，并且不会对光照贴图计算贡献任何内容（颜色或光线）。它仍然从场景的光照探针接收光照数据。在您的场景中，球体应该是黄色的。
      2. **蓝色**：游戏对象包含在光照贴图计算中，并且它从场景的光照贴图接收光照数据。这是完全烘焙的游戏对象的标准状态。场景中的环境和道具应该是蓝色的。
      3. **红色**：游戏对象包含在光照贴图计算中，并且它从场景的光照探针接收光照数据。为了使其呈红色，您的球体需要被标记为静态并有助于场景中的光照贴图。
   4. 如果您需要检查是否已正确配置场景中的游戏对象和光照，此诊断视图会非常有用。
   5. **提示**：您可以在“首选项”窗口中自定义此绘制模式的颜色。

5. 完成后，  在“场景”视图控制栏中，将 `Draw Mode` 设置回 `Shaded` 。


### 8.探索：自定义您的光照贴图

`Lighting Tab` 中可设置的一些属性：

1. Lightmap Resolution：这控制光照贴图的质量。降低分辨率会降低烘焙照明的质量，但也会减少烘焙时间。尝试增加此属性的值以查看对质量和烘烤时间的影响。

2. Albedo Boost：这控制 Unity 在场景中的表面之间反射的光量。增加该值将增强场景中材质的反照率。

3. Max Bounces：间接照明中包含的最大光反射次数。

4. Indirect Intensity：这控制光照贴图中间接光的亮度。

> Albedo Boost、Max Bounces 和 Indirect Intensity 共同影响场景中的光量

5. Ambient Occlusion(环境光遮挡)：模拟附近物体遮挡间接光造成的微妙阴影效果，增强场景的真实感。它最常被视为墙壁相交的角落里的黑暗区域。左下图禁用了环境光遮挡，而右图则启用了该功能。

6. Ambient Occlusion - Max Distance(环境光遮挡最大距离)：此属性确定应用环境光遮挡的最大范围。使用较高的“最大距离”值，阴影将覆盖给定表面上的更大区域。尝试增加此属性的值以探索场景中的效果。下图左侧的“最大距离”设置为 1，右侧图像的“最大距离”设置为 3。

> Tips：请记住，其中一些设置可能会提高项目中照明的真实感或质量，但它们也会显着增加交付照明所需的内存和处理能力。你的烘烤时间可能会增加。


## 检查并完成室内场景

现在您已经致力于在室外场景中实现照明，是时候将注意力转向室内了。相同的照明基本原理也适用于室内环境，但正如物理世界中室内和室外的光往往有所不同一样，在为室内空间照明以获得实时体验时，需要特别考虑一些特别的因素。

学完本教程后，您将能够：
- 确定实际照明室内场景的关键考虑因素。
- 将发射材质添加到场景中。
- 在诊断视图中检查发射材料。
- 将光探针放置在场景内的 3D 体积排列中。